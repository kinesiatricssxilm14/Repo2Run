#0 building with "default" instance using docker driver

#1 [internal] load build definition from Dockerfile
#1 transferring dockerfile: 1.09kB done
#1 DONE 0.0s

#2 [internal] load metadata for docker.io/library/python:3.10
#2 DONE 0.0s

#3 [internal] load .dockerignore
#3 transferring context: 2B done
#3 DONE 0.0s

#4 [1/5] FROM docker.io/library/python:3.10
#4 DONE 0.0s

#5 [2/5] RUN mkdir -p ~/.pip && touch ~/.pip/pip.conf &&     echo "[global]" >> ~/.pip/pip.conf && echo "index-url=http://simple/" >> ~/.pip/pip.conf && echo "[install]" >> ~/.pip/pip.conf && echo "trusted-host=pypi..org" >> ~/.pip/pip.conf &&     apt-get update && apt-get install -y curl &&     curl -sSL https://install.python-poetry.org | python -
#5 CACHED

#6 [3/5] RUN pip install pytest pytest-xdist &&     pip install pipdeptree &&     git clone https://github.com/apple/ml-cross-entropy.git &&     mkdir /repo &&     git config --global --add safe.directory /repo &&     cp -r /ml-cross-entropy/. /repo && rm -rf /ml-cross-entropy/ &&     rm -rf /ml-cross-entropy &&     cd /repo && git checkout 9c297c905f55b73594b5d650722d1e78183b77bd &&     cd /repo && pip install -e .[dev]
#6 1.634 Looking in indexes: http://simple/
#6 1.787 Collecting pytest
#6 1.804   Downloading http://packages/pytest/pytest-8.3.4-py3-none-any.whl (343 kB)
#6 1.830      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 343.1/343.1 kB 16.4 MB/s eta 0:00:00
#6 1.901 Collecting pytest-xdist
#6 1.921   Downloading http://packages/pytest-xdist/pytest_xdist-3.6.1-py3-none-any.whl (46 kB)
#6 1.933      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 46.1/46.1 kB 4.5 MB/s eta 0:00:00
#6 1.996 Collecting pluggy<2,>=1.5
#6 2.014   Downloading http://packages/pluggy/pluggy-1.5.0-py3-none-any.whl (20 kB)
#6 2.070 Collecting tomli>=1
#6 2.089   Downloading http://packages/tomli/tomli-2.2.1-py3-none-any.whl (14 kB)
#6 2.136 Collecting exceptiongroup>=1.0.0rc8
#6 2.153   Downloading http://packages/exceptiongroup/exceptiongroup-1.2.2-py3-none-any.whl (16 kB)
#6 2.188 Collecting iniconfig
#6 2.206   Downloading http://packages/iniconfig/iniconfig-2.0.0-py3-none-any.whl (5.9 kB)
#6 2.278 Collecting packaging
#6 2.300   Downloading http://packages/packaging/packaging-24.2-py3-none-any.whl (65 kB)
#6 2.313      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 65.5/65.5 kB 6.9 MB/s eta 0:00:00
#6 2.410 Collecting execnet>=2.1
#6 2.430   Downloading http://packages/execnet/execnet-2.1.1-py3-none-any.whl (40 kB)
#6 2.440      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 40.6/40.6 kB 7.0 MB/s eta 0:00:00
#6 2.592 Installing collected packages: tomli, pluggy, packaging, iniconfig, execnet, exceptiongroup, pytest, pytest-xdist
#6 3.138 Successfully installed exceptiongroup-1.2.2 execnet-2.1.1 iniconfig-2.0.0 packaging-24.2 pluggy-1.5.0 pytest-8.3.4 pytest-xdist-3.6.1 tomli-2.2.1
#6 3.139 WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv
#6 3.269 
#6 3.269 [notice] A new release of pip is available: 23.0.1 -> 24.3.1
#6 3.269 [notice] To update, run: pip install --upgrade pip
#6 4.013 Looking in indexes: http://simple/
#6 4.095 Collecting pipdeptree
#6 4.113   Downloading http://packages/pipdeptree/pipdeptree-2.24.0-py3-none-any.whl (32 kB)
#6 4.252 Collecting pip>=24.2
#6 4.262   Using cached http://packages/pip/pip-24.3.1-py3-none-any.whl (1.8 MB)
#6 4.280 Requirement already satisfied: packaging>=24.1 in /usr/local/lib/python3.10/site-packages (from pipdeptree) (24.2)
#6 4.389 Installing collected packages: pip, pipdeptree
#6 4.389   Attempting uninstall: pip
#6 4.391     Found existing installation: pip 23.0.1
#6 4.566     Uninstalling pip-23.0.1:
#6 4.713       Successfully uninstalled pip-23.0.1
#6 5.946 Successfully installed pip-24.3.1 pipdeptree-2.24.0
#6 5.946 WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv
#6 6.118 Cloning into 'ml-cross-entropy'...
#6 8.058 Note: switching to '9c297c905f55b73594b5d650722d1e78183b77bd'.
#6 8.058 
#6 8.058 You are in 'detached HEAD' state. You can look around, make experimental
#6 8.058 changes and commit them, and you can discard any commits you make in this
#6 8.058 state without impacting any branches by switching back to a branch.
#6 8.058 
#6 8.058 If you want to create a new branch to retain commits you create, you may
#6 8.058 do so (now or later) by using -c with the switch command. Example:
#6 8.058 
#6 8.058   git switch -c <new-branch-name>
#6 8.058 
#6 8.058 Or undo this operation with:
#6 8.058 
#6 8.058   git switch -
#6 8.058 
#6 8.058 Turn off this advice by setting config variable advice.detachedHead to false
#6 8.058 
#6 8.058 HEAD is now at 9c297c9 Update eps, fix typo
#6 8.574 Looking in indexes: http://simple/
#6 8.574 Obtaining file:///repo
#6 8.578   Installing build dependencies: started
#6 11.08   Installing build dependencies: finished with status 'done'
#6 11.08   Checking if build backend supports build_editable: started
#6 11.32   Checking if build backend supports build_editable: finished with status 'done'
#6 11.32   Getting requirements to build editable: started
#6 11.70   Getting requirements to build editable: finished with status 'done'
#6 11.70   Preparing editable metadata (pyproject.toml): started
#6 12.09   Preparing editable metadata (pyproject.toml): finished with status 'done'
#6 12.26 Collecting torch>=2.4 (from cut-cross-entropy==24.11.4)
#6 12.28   Downloading http://packages/torch/torch-2.5.1-cp310-cp310-manylinux1_x86_64.whl (906.4 MB)
#6 23.23      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 906.4/906.4 MB 29.9 MB/s eta 0:00:00
#6 27.37 Collecting triton>=3.0.0 (from cut-cross-entropy==24.11.4)
#6 27.39   Downloading http://packages/triton/triton-3.1.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (209.5 MB)
#6 28.58      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 209.5/209.5 MB 178.5 MB/s eta 0:00:00
#6 29.40 Collecting build (from cut-cross-entropy==24.11.4)
#6 29.40   Using cached http://packages/build/build-1.2.2.post1-py3-none-any.whl (22 kB)
#6 29.46 Collecting twine (from cut-cross-entropy==24.11.4)
#6 29.48   Downloading http://packages/twine/twine-6.0.1-py3-none-any.whl (39 kB)
#6 29.59 Collecting pre-commit (from cut-cross-entropy==24.11.4)
#6 29.61   Downloading http://packages/pre-commit/pre_commit-4.0.1-py2.py3-none-any.whl (218 kB)
#6 29.69 Collecting filelock (from torch>=2.4->cut-cross-entropy==24.11.4)
#6 29.70   Using cached http://packages/filelock/filelock-3.16.1-py3-none-any.whl (16 kB)
#6 29.74 Collecting typing-extensions>=4.8.0 (from torch>=2.4->cut-cross-entropy==24.11.4)
#6 29.76   Downloading http://packages/typing-extensions/typing_extensions-4.12.2-py3-none-any.whl (37 kB)
#6 29.83 Collecting networkx (from torch>=2.4->cut-cross-entropy==24.11.4)
#6 29.85   Downloading http://packages/networkx/networkx-3.4.2-py3-none-any.whl (1.7 MB)
#6 29.89      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.7/1.7 MB 66.2 MB/s eta 0:00:00
#6 29.95 Collecting jinja2 (from torch>=2.4->cut-cross-entropy==24.11.4)
#6 29.97   Downloading http://packages/jinja2/jinja2-3.1.5-py3-none-any.whl (134 kB)
#6 30.04 Collecting fsspec (from torch>=2.4->cut-cross-entropy==24.11.4)
#6 30.06   Downloading http://packages/fsspec/fsspec-2024.12.0-py3-none-any.whl (183 kB)
#6 30.17 Collecting nvidia-cuda-nvrtc-cu12==12.4.127 (from torch>=2.4->cut-cross-entropy==24.11.4)
#6 30.19   Downloading http://packages/nvidia-cuda-nvrtc-cu12/nvidia_cuda_nvrtc_cu12-12.4.127-py3-none-manylinux2014_x86_64.whl (24.6 MB)
#6 30.34      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 24.6/24.6 MB 182.9 MB/s eta 0:00:00
#6 30.48 Collecting nvidia-cuda-runtime-cu12==12.4.127 (from torch>=2.4->cut-cross-entropy==24.11.4)
#6 30.50   Downloading http://packages/nvidia-cuda-runtime-cu12/nvidia_cuda_runtime_cu12-12.4.127-py3-none-manylinux2014_x86_64.whl (883 kB)
#6 30.54      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 883.7/883.7 kB 39.9 MB/s eta 0:00:00
#6 30.57 Collecting nvidia-cuda-cupti-cu12==12.4.127 (from torch>=2.4->cut-cross-entropy==24.11.4)
#6 30.59   Downloading http://packages/nvidia-cuda-cupti-cu12/nvidia_cuda_cupti_cu12-12.4.127-py3-none-manylinux2014_x86_64.whl (13.8 MB)
#6 30.69      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 13.8/13.8 MB 168.7 MB/s eta 0:00:00
#6 30.76 Collecting nvidia-cudnn-cu12==9.1.0.70 (from torch>=2.4->cut-cross-entropy==24.11.4)
#6 30.78   Downloading http://packages/nvidia-cudnn-cu12/nvidia_cudnn_cu12-9.1.0.70-py3-none-manylinux2014_x86_64.whl (664.8 MB)
#6 36.21      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 664.8/664.8 MB 62.6 MB/s eta 0:00:00
#6 38.35 Collecting nvidia-cublas-cu12==12.4.5.8 (from torch>=2.4->cut-cross-entropy==24.11.4)
#6 38.37   Downloading http://packages/nvidia-cublas-cu12/nvidia_cublas_cu12-12.4.5.8-py3-none-manylinux2014_x86_64.whl (363.4 MB)
#6 40.80      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 363.4/363.4 MB 121.9 MB/s eta 0:00:00
#6 42.00 Collecting nvidia-cufft-cu12==11.2.1.3 (from torch>=2.4->cut-cross-entropy==24.11.4)
#6 42.02   Downloading http://packages/nvidia-cufft-cu12/nvidia_cufft_cu12-11.2.1.3-py3-none-manylinux2014_x86_64.whl (211.5 MB)
#6 43.13      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 211.5/211.5 MB 191.9 MB/s eta 0:00:00
#6 43.92 Collecting nvidia-curand-cu12==10.3.5.147 (from torch>=2.4->cut-cross-entropy==24.11.4)
#6 43.95   Downloading http://packages/nvidia-curand-cu12/nvidia_curand_cu12-10.3.5.147-py3-none-manylinux2014_x86_64.whl (56.3 MB)
#6 44.23      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 56.3/56.3 MB 209.8 MB/s eta 0:00:00
#6 44.46 Collecting nvidia-cusolver-cu12==11.6.1.9 (from torch>=2.4->cut-cross-entropy==24.11.4)
#6 44.48   Downloading http://packages/nvidia-cusolver-cu12/nvidia_cusolver_cu12-11.6.1.9-py3-none-manylinux2014_x86_64.whl (127.9 MB)
#6 45.25      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 127.9/127.9 MB 168.0 MB/s eta 0:00:00
#6 45.67 Collecting nvidia-cusparse-cu12==12.3.1.170 (from torch>=2.4->cut-cross-entropy==24.11.4)
#6 45.69   Downloading http://packages/nvidia-cusparse-cu12/nvidia_cusparse_cu12-12.3.1.170-py3-none-manylinux2014_x86_64.whl (207.5 MB)
#6 46.71      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 207.5/207.5 MB 207.6 MB/s eta 0:00:00
#6 47.45 Collecting nvidia-nccl-cu12==2.21.5 (from torch>=2.4->cut-cross-entropy==24.11.4)
#6 47.47   Downloading http://packages/nvidia-nccl-cu12/nvidia_nccl_cu12-2.21.5-py3-none-manylinux2014_x86_64.whl (188.7 MB)
#6 48.44      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 188.7/188.7 MB 196.4 MB/s eta 0:00:00
#6 49.19 Collecting nvidia-nvtx-cu12==12.4.127 (from torch>=2.4->cut-cross-entropy==24.11.4)
#6 49.21   Downloading http://packages/nvidia-nvtx-cu12/nvidia_nvtx_cu12-12.4.127-py3-none-manylinux2014_x86_64.whl (99 kB)
#6 49.25 Collecting nvidia-nvjitlink-cu12==12.4.127 (from torch>=2.4->cut-cross-entropy==24.11.4)
#6 49.27   Downloading http://packages/nvidia-nvjitlink-cu12/nvidia_nvjitlink_cu12-12.4.127-py3-none-manylinux2014_x86_64.whl (21.1 MB)
#6 49.41      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 21.1/21.1 MB 168.2 MB/s eta 0:00:00
#6 49.52 Collecting sympy==1.13.1 (from torch>=2.4->cut-cross-entropy==24.11.4)
#6 49.54   Downloading http://packages/sympy/sympy-1.13.1-py3-none-any.whl (6.2 MB)
#6 49.64      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 6.2/6.2 MB 71.6 MB/s eta 0:00:00
#6 49.73 Collecting mpmath<1.4,>=1.1.0 (from sympy==1.13.1->torch>=2.4->cut-cross-entropy==24.11.4)
#6 49.75   Downloading http://packages/mpmath/mpmath-1.3.0-py3-none-any.whl (536 kB)
#6 49.78      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 536.2/536.2 kB 24.7 MB/s eta 0:00:00
#6 49.79 Requirement already satisfied: packaging>=19.1 in /usr/local/lib/python3.10/site-packages (from build->cut-cross-entropy==24.11.4) (24.2)
#6 49.81 Collecting pyproject_hooks (from build->cut-cross-entropy==24.11.4)
#6 49.81   Using cached http://packages/pyproject-hooks/pyproject_hooks-1.2.0-py3-none-any.whl (10 kB)
#6 49.81 Requirement already satisfied: tomli>=1.1.0 in /usr/local/lib/python3.10/site-packages (from build->cut-cross-entropy==24.11.4) (2.2.1)
#6 49.82 Requirement already satisfied: pytest in /usr/local/lib/python3.10/site-packages (from cut-cross-entropy==24.11.4) (8.3.4)
#6 49.86 Collecting deepspeed>=0.15.1 (from cut-cross-entropy==24.11.4)
#6 49.89   Downloading http://packages/deepspeed/deepspeed-0.16.2.tar.gz (1.4 MB)
#6 49.93      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.4/1.4 MB 32.9 MB/s eta 0:00:00
#6 50.53   Preparing metadata (setup.py): started
#6 52.22   Preparing metadata (setup.py): finished with status 'done'
#6 52.28 Collecting accelerate>=0.34.2 (from cut-cross-entropy==24.11.4)
#6 52.30   Downloading http://packages/accelerate/accelerate-1.2.1-py3-none-any.whl (336 kB)
#6 52.42 Collecting datasets>=3.1.0 (from cut-cross-entropy==24.11.4)
#6 52.43   Downloading http://packages/datasets/datasets-3.2.0-py3-none-any.whl (480 kB)
#6 52.61 Collecting huggingface_hub>=0.26.2 (from cut-cross-entropy==24.11.4)
#6 52.63   Downloading http://packages/huggingface-hub/huggingface_hub-0.27.1-py3-none-any.whl (450 kB)
#6 53.01 Collecting pandas (from cut-cross-entropy==24.11.4)
#6 53.03   Downloading http://packages/pandas/pandas-2.2.3-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (13.1 MB)
#6 53.13      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 13.1/13.1 MB 147.4 MB/s eta 0:00:00
#6 53.26 Collecting fire (from cut-cross-entropy==24.11.4)
#6 53.28   Downloading http://packages/fire/fire-0.7.0.tar.gz (87 kB)
#6 53.32   Preparing metadata (setup.py): started
#6 53.72   Preparing metadata (setup.py): finished with status 'done'
#6 53.83 Collecting tqdm (from cut-cross-entropy==24.11.4)
#6 53.85   Downloading http://packages/tqdm/tqdm-4.67.1-py3-none-any.whl (78 kB)
#6 53.90 Collecting cfgv>=2.0.0 (from pre-commit->cut-cross-entropy==24.11.4)
#6 53.92   Downloading http://packages/cfgv/cfgv-3.4.0-py2.py3-none-any.whl (7.2 kB)
#6 54.06 Collecting identify>=1.0.0 (from pre-commit->cut-cross-entropy==24.11.4)
#6 54.08   Downloading http://packages/identify/identify-2.6.5-py2.py3-none-any.whl (99 kB)
#6 54.13 Collecting nodeenv>=0.11.1 (from pre-commit->cut-cross-entropy==24.11.4)
#6 54.15   Downloading http://packages/nodeenv/nodeenv-1.9.1-py2.py3-none-any.whl (22 kB)
#6 54.25 Collecting pyyaml>=5.1 (from pre-commit->cut-cross-entropy==24.11.4)
#6 54.27   Downloading http://packages/pyyaml/PyYAML-6.0.2-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (751 kB)
#6 54.31      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 751.2/751.2 kB 31.3 MB/s eta 0:00:00
#6 54.48 Collecting virtualenv>=20.10.0 (from pre-commit->cut-cross-entropy==24.11.4)
#6 54.48   Using cached http://packages/virtualenv/virtualenv-20.28.1-py3-none-any.whl (4.3 MB)
#6 54.55 Collecting pkginfo>=1.8.1 (from twine->cut-cross-entropy==24.11.4)
#6 54.55   Using cached http://packages/pkginfo/pkginfo-1.12.0-py3-none-any.whl (32 kB)
#6 54.61 Collecting readme-renderer>=35.0 (from twine->cut-cross-entropy==24.11.4)
#6 54.63   Downloading http://packages/readme-renderer/readme_renderer-44.0-py3-none-any.whl (13 kB)
#6 54.71 Collecting requests>=2.20 (from twine->cut-cross-entropy==24.11.4)
#6 54.71   Using cached http://packages/requests/requests-2.32.3-py3-none-any.whl (64 kB)
#6 54.74 Collecting requests-toolbelt!=0.9.0,>=0.8.0 (from twine->cut-cross-entropy==24.11.4)
#6 54.75   Using cached http://packages/requests-toolbelt/requests_toolbelt-1.0.0-py2.py3-none-any.whl (54 kB)
#6 54.83 Collecting urllib3>=1.26.0 (from twine->cut-cross-entropy==24.11.4)
#6 54.84   Using cached http://packages/urllib3/urllib3-2.3.0-py3-none-any.whl (128 kB)
#6 54.93 Collecting keyring>=15.1 (from twine->cut-cross-entropy==24.11.4)
#6 54.94   Using cached http://packages/keyring/keyring-25.6.0-py3-none-any.whl (39 kB)
#6 54.97 Collecting rfc3986>=1.4.0 (from twine->cut-cross-entropy==24.11.4)
#6 54.99   Downloading http://packages/rfc3986/rfc3986-2.0.0-py2.py3-none-any.whl (31 kB)
#6 55.13 Collecting rich>=12.0.0 (from twine->cut-cross-entropy==24.11.4)
#6 55.15   Downloading http://packages/rich/rich-13.9.4-py3-none-any.whl (242 kB)
#6 55.65 Collecting numpy<3.0.0,>=1.17 (from accelerate>=0.34.2->cut-cross-entropy==24.11.4)
#6 55.67   Downloading http://packages/numpy/numpy-2.2.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (16.4 MB)
#6 55.78      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 16.4/16.4 MB 171.1 MB/s eta 0:00:00
#6 56.04 Collecting psutil (from accelerate>=0.34.2->cut-cross-entropy==24.11.4)
#6 56.06   Downloading http://packages/psutil/psutil-6.1.1-cp36-abi3-manylinux_2_12_x86_64.manylinux2010_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl (287 kB)
#6 56.37 Collecting safetensors>=0.4.3 (from accelerate>=0.34.2->cut-cross-entropy==24.11.4)
#6 56.39   Downloading http://packages/safetensors/safetensors-0.5.1-cp38-abi3-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (461 kB)
#6 56.62 Collecting pyarrow>=15.0.0 (from datasets>=3.1.0->cut-cross-entropy==24.11.4)
#6 56.64   Downloading http://packages/pyarrow/pyarrow-18.1.0-cp310-cp310-manylinux_2_28_x86_64.whl (40.1 MB)
#6 56.86      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 40.1/40.1 MB 195.3 MB/s eta 0:00:00
#6 57.02 Collecting dill<0.3.9,>=0.3.0 (from datasets>=3.1.0->cut-cross-entropy==24.11.4)
#6 57.04   Downloading http://packages/dill/dill-0.3.8-py3-none-any.whl (116 kB)
#6 57.26 Collecting xxhash (from datasets>=3.1.0->cut-cross-entropy==24.11.4)
#6 57.28   Downloading http://packages/xxhash/xxhash-3.5.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (194 kB)
#6 57.34 Collecting multiprocess<0.70.17 (from datasets>=3.1.0->cut-cross-entropy==24.11.4)
#6 57.36   Downloading http://packages/multiprocess/multiprocess-0.70.16-py310-none-any.whl (134 kB)
#6 57.40 Collecting fsspec (from torch>=2.4->cut-cross-entropy==24.11.4)
#6 57.42   Downloading http://packages/fsspec/fsspec-2024.9.0-py3-none-any.whl (179 kB)
#6 58.44 Collecting aiohttp (from datasets>=3.1.0->cut-cross-entropy==24.11.4)
#6 58.46   Downloading http://packages/aiohttp/aiohttp-3.11.11-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (1.6 MB)
#6 58.50      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.6/1.6 MB 60.9 MB/s eta 0:00:00
#6 58.56 Collecting einops (from deepspeed>=0.15.1->cut-cross-entropy==24.11.4)
#6 58.58   Downloading http://packages/einops/einops-0.8.0-py3-none-any.whl (43 kB)
#6 58.61 Collecting hjson (from deepspeed>=0.15.1->cut-cross-entropy==24.11.4)
#6 58.62   Downloading http://packages/hjson/hjson-3.1.0-py3-none-any.whl (54 kB)
#6 58.78 Collecting msgpack (from deepspeed>=0.15.1->cut-cross-entropy==24.11.4)
#6 58.78   Using cached http://packages/msgpack/msgpack-1.1.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (378 kB)
#6 58.85 Collecting ninja (from deepspeed>=0.15.1->cut-cross-entropy==24.11.4)
#6 58.87   Downloading http://packages/ninja/ninja-1.11.1.3-py3-none-manylinux_2_12_x86_64.manylinux2010_x86_64.whl (422 kB)
#6 58.93 Collecting py-cpuinfo (from deepspeed>=0.15.1->cut-cross-entropy==24.11.4)
#6 58.94   Downloading http://packages/py-cpuinfo/py_cpuinfo-9.0.0-py3-none-any.whl (22 kB)
#6 59.22 Collecting pydantic>=2.0.0 (from deepspeed>=0.15.1->cut-cross-entropy==24.11.4)
#6 59.24   Downloading http://packages/pydantic/pydantic-2.10.4-py3-none-any.whl (431 kB)
#6 59.34 Collecting SecretStorage>=3.2 (from keyring>=15.1->twine->cut-cross-entropy==24.11.4)
#6 59.34   Using cached http://packages/secretstorage/SecretStorage-3.3.3-py3-none-any.whl (15 kB)
#6 59.37 Collecting jeepney>=0.4.2 (from keyring>=15.1->twine->cut-cross-entropy==24.11.4)
#6 59.37   Using cached http://packages/jeepney/jeepney-0.8.0-py3-none-any.whl (48 kB)
#6 59.50 Collecting importlib_metadata>=4.11.4 (from keyring>=15.1->twine->cut-cross-entropy==24.11.4)
#6 59.50   Using cached http://packages/importlib-metadata/importlib_metadata-8.5.0-py3-none-any.whl (26 kB)
#6 59.54 Collecting jaraco.classes (from keyring>=15.1->twine->cut-cross-entropy==24.11.4)
#6 59.54   Using cached http://packages/jaraco-classes/jaraco.classes-3.4.0-py3-none-any.whl (6.8 kB)
#6 59.59 Collecting jaraco.functools (from keyring>=15.1->twine->cut-cross-entropy==24.11.4)
#6 59.59   Using cached http://packages/jaraco-functools/jaraco.functools-4.1.0-py3-none-any.whl (10 kB)
#6 59.63 Collecting jaraco.context (from keyring>=15.1->twine->cut-cross-entropy==24.11.4)
#6 59.63   Using cached http://packages/jaraco-context/jaraco.context-6.0.1-py3-none-any.whl (6.8 kB)
#6 59.74 Collecting nh3>=0.2.14 (from readme-renderer>=35.0->twine->cut-cross-entropy==24.11.4)
#6 59.76   Downloading http://packages/nh3/nh3-0.2.20-cp38-abi3-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (744 kB)
#6 59.79      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 744.4/744.4 kB 35.2 MB/s eta 0:00:00
#6 59.84 Collecting docutils>=0.21.2 (from readme-renderer>=35.0->twine->cut-cross-entropy==24.11.4)
#6 59.86   Downloading http://packages/docutils/docutils-0.21.2-py3-none-any.whl (587 kB)
#6 59.88      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 587.4/587.4 kB 29.9 MB/s eta 0:00:00
#6 59.94 Collecting Pygments>=2.5.1 (from readme-renderer>=35.0->twine->cut-cross-entropy==24.11.4)
#6 59.96   Downloading http://packages/pygments/pygments-2.19.1-py3-none-any.whl (1.2 MB)
#6 59.99      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.2/1.2 MB 55.6 MB/s eta 0:00:00
#6 60.19 Collecting charset-normalizer<4,>=2 (from requests>=2.20->twine->cut-cross-entropy==24.11.4)
#6 60.19   Using cached http://packages/charset-normalizer/charset_normalizer-3.4.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (146 kB)
#6 60.23 Collecting idna<4,>=2.5 (from requests>=2.20->twine->cut-cross-entropy==24.11.4)
#6 60.23   Using cached http://packages/idna/idna-3.10-py3-none-any.whl (70 kB)
#6 60.29 Collecting certifi>=2017.4.17 (from requests>=2.20->twine->cut-cross-entropy==24.11.4)
#6 60.30   Using cached http://packages/certifi/certifi-2024.12.14-py3-none-any.whl (164 kB)
#6 60.37 Collecting markdown-it-py>=2.2.0 (from rich>=12.0.0->twine->cut-cross-entropy==24.11.4)
#6 60.39   Downloading http://packages/markdown-it-py/markdown_it_py-3.0.0-py3-none-any.whl (87 kB)
#6 60.47 Collecting distlib<1,>=0.3.7 (from virtualenv>=20.10.0->pre-commit->cut-cross-entropy==24.11.4)
#6 60.47   Using cached http://packages/distlib/distlib-0.3.9-py2.py3-none-any.whl (468 kB)
#6 60.53 Collecting platformdirs<5,>=3.9.1 (from virtualenv>=20.10.0->pre-commit->cut-cross-entropy==24.11.4)
#6 60.53   Using cached http://packages/platformdirs/platformdirs-4.3.6-py3-none-any.whl (18 kB)
#6 60.80 Collecting transformers>=4.44.2 (from cut-cross-entropy==24.11.4)
#6 60.83   Downloading http://packages/transformers/transformers-4.47.1-py3-none-any.whl (10.1 MB)
#6 60.91      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 10.1/10.1 MB 155.5 MB/s eta 0:00:00
#6 61.26 Collecting termcolor (from fire->cut-cross-entropy==24.11.4)
#6 61.28   Downloading http://packages/termcolor/termcolor-2.5.0-py3-none-any.whl (7.8 kB)
#6 61.41 Collecting MarkupSafe>=2.0 (from jinja2->torch>=2.4->cut-cross-entropy==24.11.4)
#6 61.43   Downloading http://packages/markupsafe/MarkupSafe-3.0.2-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (20 kB)
#6 61.50 Collecting python-dateutil>=2.8.2 (from pandas->cut-cross-entropy==24.11.4)
#6 61.52   Downloading http://packages/python-dateutil/python_dateutil-2.9.0.post0-py2.py3-none-any.whl (229 kB)
#6 61.64 Collecting pytz>=2020.1 (from pandas->cut-cross-entropy==24.11.4)
#6 61.67   Downloading http://packages/pytz/pytz-2024.2-py2.py3-none-any.whl (508 kB)
#6 61.99 Collecting tzdata>=2022.7 (from pandas->cut-cross-entropy==24.11.4)
#6 62.01   Downloading http://packages/tzdata/tzdata-2024.2-py2.py3-none-any.whl (346 kB)
#6 62.63 Requirement already satisfied: exceptiongroup>=1.0.0rc8 in /usr/local/lib/python3.10/site-packages (from pytest->cut-cross-entropy==24.11.4) (1.2.2)
#6 62.63 Requirement already satisfied: iniconfig in /usr/local/lib/python3.10/site-packages (from pytest->cut-cross-entropy==24.11.4) (2.0.0)
#6 62.63 Requirement already satisfied: pluggy<2,>=1.5 in /usr/local/lib/python3.10/site-packages (from pytest->cut-cross-entropy==24.11.4) (1.5.0)
#6 62.77 Collecting aiohappyeyeballs>=2.3.0 (from aiohttp->datasets>=3.1.0->cut-cross-entropy==24.11.4)
#6 62.79   Downloading http://packages/aiohappyeyeballs/aiohappyeyeballs-2.4.4-py3-none-any.whl (14 kB)
#6 63.24 Collecting aiosignal>=1.1.2 (from aiohttp->datasets>=3.1.0->cut-cross-entropy==24.11.4)
#6 63.26   Downloading http://packages/aiosignal/aiosignal-1.3.2-py2.py3-none-any.whl (7.6 kB)
#6 64.53 Collecting async-timeout<6.0,>=4.0 (from aiohttp->datasets>=3.1.0->cut-cross-entropy==24.11.4)
#6 64.55   Downloading http://packages/async-timeout/async_timeout-5.0.1-py3-none-any.whl (6.2 kB)
#6 65.49 Collecting attrs>=17.3.0 (from aiohttp->datasets>=3.1.0->cut-cross-entropy==24.11.4)
#6 65.52   Downloading http://packages/attrs/attrs-24.3.0-py3-none-any.whl (63 kB)
#6 65.66 Collecting frozenlist>=1.1.1 (from aiohttp->datasets>=3.1.0->cut-cross-entropy==24.11.4)
#6 65.69   Downloading http://packages/frozenlist/frozenlist-1.5.0-cp310-cp310-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl (241 kB)
#6 66.06 Collecting multidict<7.0,>=4.5 (from aiohttp->datasets>=3.1.0->cut-cross-entropy==24.11.4)
#6 66.08   Downloading http://packages/multidict/multidict-6.1.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (124 kB)
#6 66.17 Collecting propcache>=0.2.0 (from aiohttp->datasets>=3.1.0->cut-cross-entropy==24.11.4)
#6 66.19   Downloading http://packages/propcache/propcache-0.2.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (205 kB)
#6 66.96 Collecting yarl<2.0,>=1.17.0 (from aiohttp->datasets>=3.1.0->cut-cross-entropy==24.11.4)
#6 66.98   Downloading http://packages/yarl/yarl-1.18.3-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (319 kB)
#6 67.06 Collecting zipp>=3.20 (from importlib_metadata>=4.11.4->keyring>=15.1->twine->cut-cross-entropy==24.11.4)
#6 67.06   Using cached http://packages/zipp/zipp-3.21.0-py3-none-any.whl (9.6 kB)
#6 67.10 Collecting mdurl~=0.1 (from markdown-it-py>=2.2.0->rich>=12.0.0->twine->cut-cross-entropy==24.11.4)
#6 67.12   Downloading http://packages/mdurl/mdurl-0.1.2-py3-none-any.whl (10.0 kB)
#6 67.21 Collecting annotated-types>=0.6.0 (from pydantic>=2.0.0->deepspeed>=0.15.1->cut-cross-entropy==24.11.4)
#6 67.23   Downloading http://packages/annotated-types/annotated_types-0.7.0-py3-none-any.whl (13 kB)
#6 68.48 Collecting pydantic-core==2.27.2 (from pydantic>=2.0.0->deepspeed>=0.15.1->cut-cross-entropy==24.11.4)
#6 68.50   Downloading http://packages/pydantic-core/pydantic_core-2.27.2-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (2.0 MB)
#6 68.54      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 2.0/2.0 MB 78.5 MB/s eta 0:00:00
#6 68.60 Collecting six>=1.5 (from python-dateutil>=2.8.2->pandas->cut-cross-entropy==24.11.4)
#6 68.63   Downloading http://packages/six/six-1.17.0-py2.py3-none-any.whl (11 kB)
#6 69.03 Collecting cryptography>=2.0 (from SecretStorage>=3.2->keyring>=15.1->twine->cut-cross-entropy==24.11.4)
#6 69.03   Using cached http://packages/cryptography/cryptography-44.0.0-cp39-abi3-manylinux_2_28_x86_64.whl (4.2 MB)
#6 70.04 Collecting regex!=2019.12.17 (from transformers>=4.44.2->cut-cross-entropy==24.11.4)
#6 70.06   Downloading http://packages/regex/regex-2024.11.6-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (781 kB)
#6 70.09      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 781.7/781.7 kB 39.9 MB/s eta 0:00:00
#6 70.47 Collecting tokenizers<0.22,>=0.21 (from transformers>=4.44.2->cut-cross-entropy==24.11.4)
#6 70.48   Downloading http://packages/tokenizers/tokenizers-0.21.0-cp39-abi3-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (3.0 MB)
#6 70.53      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 3.0/3.0 MB 91.2 MB/s eta 0:00:00
#6 70.63 Collecting more-itertools (from jaraco.classes->keyring>=15.1->twine->cut-cross-entropy==24.11.4)
#6 70.63   Using cached http://packages/more-itertools/more_itertools-10.5.0-py3-none-any.whl (60 kB)
#6 70.66 Collecting backports.tarfile (from jaraco.context->keyring>=15.1->twine->cut-cross-entropy==24.11.4)
#6 70.66   Using cached http://packages/backports-tarfile/backports.tarfile-1.2.0-py3-none-any.whl (30 kB)
#6 70.97 Collecting cffi>=1.12 (from cryptography>=2.0->SecretStorage>=3.2->keyring>=15.1->twine->cut-cross-entropy==24.11.4)
#6 70.98   Using cached http://packages/cffi/cffi-1.17.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (446 kB)
#6 71.13 Collecting pycparser (from cffi>=1.12->cryptography>=2.0->SecretStorage>=3.2->keyring>=15.1->twine->cut-cross-entropy==24.11.4)
#6 71.13   Using cached http://packages/pycparser/pycparser-2.22-py3-none-any.whl (117 kB)
#6 71.15 Building wheels for collected packages: cut-cross-entropy, deepspeed, fire
#6 71.15   Building editable for cut-cross-entropy (pyproject.toml): started
#6 71.86   Building editable for cut-cross-entropy (pyproject.toml): finished with status 'done'
#6 71.86   Created wheel for cut-cross-entropy: filename=cut_cross_entropy-24.11.4-0.editable-py3-none-any.whl size=7743 sha256=abee5c0b0f611ad38550ce7333b13dd5f566c9b520a10371e9787d2909b057f0
#6 71.86   Stored in directory: /tmp/pip-ephem-wheel-cache-aw3dl5ko/wheels/83/05/69/977b54e69478800cfcea8a9437a7ea4a9b1a48db334f824611
#6 71.86   Building wheel for deepspeed (setup.py): started
#6 73.73   Building wheel for deepspeed (setup.py): finished with status 'done'
#6 73.74   Created wheel for deepspeed: filename=deepspeed-0.16.2-py3-none-any.whl size=1547886 sha256=552648663d7e683f7ba3f51f17698cf9732d62f4ef9daf0b06d6e6f761a9eb4e
#6 73.74   Stored in directory: /root/.cache/pip/wheels/70/2b/1b/7c8c63d6b201bb8f67b05eb7cdfad04cad18bda82b4550982f
#6 73.75   Building wheel for fire (setup.py): started
#6 74.28   Building wheel for fire (setup.py): finished with status 'done'
#6 74.28   Created wheel for fire: filename=fire-0.7.0-py3-none-any.whl size=114249 sha256=ce2caaee489971ff72a20d62f121e538b8b93dadaf95e142066b556dea4c7108
#6 74.28   Stored in directory: /root/.cache/pip/wheels/4e/5f/89/2b3e534a303f708f44a198d2764667b034929076f03e6b600b
#6 74.28 Successfully built cut-cross-entropy deepspeed fire
#6 75.39 Installing collected packages: pytz, py-cpuinfo, mpmath, hjson, distlib, zipp, xxhash, urllib3, tzdata, typing-extensions, tqdm, termcolor, sympy, six, safetensors, rfc3986, regex, pyyaml, pyproject_hooks, Pygments, pycparser, pyarrow, psutil, propcache, platformdirs, pkginfo, nvidia-nvtx-cu12, nvidia-nvjitlink-cu12, nvidia-nccl-cu12, nvidia-curand-cu12, nvidia-cufft-cu12, nvidia-cuda-runtime-cu12, nvidia-cuda-nvrtc-cu12, nvidia-cuda-cupti-cu12, nvidia-cublas-cu12, numpy, nodeenv, ninja, nh3, networkx, msgpack, more-itertools, mdurl, MarkupSafe, jeepney, idna, identify, fsspec, frozenlist, filelock, einops, docutils, dill, charset-normalizer, cfgv, certifi, backports.tarfile, attrs, async-timeout, annotated-types, aiohappyeyeballs, virtualenv, triton, requests, readme-renderer, python-dateutil, pydantic-core, nvidia-cusparse-cu12, nvidia-cudnn-cu12, multiprocess, multidict, markdown-it-py, jinja2, jaraco.functools, jaraco.context, jaraco.classes, importlib_metadata, fire, cffi, build, aiosignal, yarl, rich, requests-toolbelt, pydantic, pre-commit, pandas, nvidia-cusolver-cu12, huggingface_hub, cryptography, torch, tokenizers, SecretStorage, aiohttp, transformers, keyring, deepspeed, cut-cross-entropy, accelerate, twine, datasets
#6 181.5 Successfully installed MarkupSafe-3.0.2 Pygments-2.19.1 SecretStorage-3.3.3 accelerate-1.2.1 aiohappyeyeballs-2.4.4 aiohttp-3.11.11 aiosignal-1.3.2 annotated-types-0.7.0 async-timeout-5.0.1 attrs-24.3.0 backports.tarfile-1.2.0 build-1.2.2.post1 certifi-2024.12.14 cffi-1.17.1 cfgv-3.4.0 charset-normalizer-3.4.1 cryptography-44.0.0 cut-cross-entropy-24.11.4 datasets-3.2.0 deepspeed-0.16.2 dill-0.3.8 distlib-0.3.9 docutils-0.21.2 einops-0.8.0 filelock-3.16.1 fire-0.7.0 frozenlist-1.5.0 fsspec-2024.9.0 hjson-3.1.0 huggingface_hub-0.27.1 identify-2.6.5 idna-3.10 importlib_metadata-8.5.0 jaraco.classes-3.4.0 jaraco.context-6.0.1 jaraco.functools-4.1.0 jeepney-0.8.0 jinja2-3.1.5 keyring-25.6.0 markdown-it-py-3.0.0 mdurl-0.1.2 more-itertools-10.5.0 mpmath-1.3.0 msgpack-1.1.0 multidict-6.1.0 multiprocess-0.70.16 networkx-3.4.2 nh3-0.2.20 ninja-1.11.1.3 nodeenv-1.9.1 numpy-2.2.1 nvidia-cublas-cu12-12.4.5.8 nvidia-cuda-cupti-cu12-12.4.127 nvidia-cuda-nvrtc-cu12-12.4.127 nvidia-cuda-runtime-cu12-12.4.127 nvidia-cudnn-cu12-9.1.0.70 nvidia-cufft-cu12-11.2.1.3 nvidia-curand-cu12-10.3.5.147 nvidia-cusolver-cu12-11.6.1.9 nvidia-cusparse-cu12-12.3.1.170 nvidia-nccl-cu12-2.21.5 nvidia-nvjitlink-cu12-12.4.127 nvidia-nvtx-cu12-12.4.127 pandas-2.2.3 pkginfo-1.12.0 platformdirs-4.3.6 pre-commit-4.0.1 propcache-0.2.1 psutil-6.1.1 py-cpuinfo-9.0.0 pyarrow-18.1.0 pycparser-2.22 pydantic-2.10.4 pydantic-core-2.27.2 pyproject_hooks-1.2.0 python-dateutil-2.9.0.post0 pytz-2024.2 pyyaml-6.0.2 readme-renderer-44.0 regex-2024.11.6 requests-2.32.3 requests-toolbelt-1.0.0 rfc3986-2.0.0 rich-13.9.4 safetensors-0.5.1 six-1.17.0 sympy-1.13.1 termcolor-2.5.0 tokenizers-0.21.0 torch-2.5.1 tqdm-4.67.1 transformers-4.47.1 triton-3.1.0 twine-6.0.1 typing-extensions-4.12.2 tzdata-2024.2 urllib3-2.3.0 virtualenv-20.28.1 xxhash-3.5.0 yarl-1.18.3 zipp-3.21.0
#6 181.5 WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable.It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.
#6 DONE 186.8s

#7 [4/5] RUN cd /repo && pytest --collect-only -q
#7 5.110 tests/test_cce_indexed_dot.py: 18
#7 5.110 tests/test_cce_loss_backward.py: 288
#7 5.110 tests/test_cce_loss_forward.py: 144
#7 5.110 tests/test_cce_lse.py: 18
#7 5.110 
#7 DONE 6.4s

#8 exporting to image
#8 exporting layers
#8 exporting layers 50.2s done
#8 writing image sha256:3663932514494c7809779dfdc51063e6d921153ae329148077482e9f0f061bfa done
#8 naming to docker.io/library/tmp:tmp done
#8 DONE 50.2s
