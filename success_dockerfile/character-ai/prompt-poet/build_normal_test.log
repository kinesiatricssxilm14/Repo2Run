#0 building with "default" instance using docker driver

#1 [internal] load build definition from Dockerfile
#1 transferring dockerfile: 1.07kB done
#1 DONE 0.0s

#2 [internal] load metadata for docker.io/library/python:3.10
#2 DONE 0.0s

#3 [internal] load .dockerignore
#3 transferring context: 2B done
#3 DONE 0.0s

#4 [1/5] FROM docker.io/library/python:3.10
#4 DONE 0.0s

#5 [2/5] RUN mkdir -p ~/.pip && touch ~/.pip/pip.conf &&     echo "[global]" >> ~/.pip/pip.conf && echo "index-url=http://simple/" >> ~/.pip/pip.conf && echo "[install]" >> ~/.pip/pip.conf && echo "trusted-host=pypi..org" >> ~/.pip/pip.conf &&     apt-get update && apt-get install -y curl &&     curl -sSL https://install.python-poetry.org | python -
#5 CACHED

#6 [3/5] RUN pip install pytest pytest-xdist &&     pip install pipdeptree &&     git clone https://github.com/character-ai/prompt-poet.git &&     mkdir /repo &&     git config --global --add safe.directory /repo &&     cp -r /prompt-poet/. /repo && rm -rf /prompt-poet/ &&     rm -rf /prompt-poet &&     cd /repo && git checkout 4664320754eb7789f69820ce6bd8108279524a44 &&     cd /repo && pip install -e .
#6 1.826 Looking in indexes: http://simple/
#6 1.981 Collecting pytest
#6 1.998   Downloading http://packages/pytest/pytest-8.3.4-py3-none-any.whl (343 kB)
#6 2.013      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 343.1/343.1 kB 34.6 MB/s eta 0:00:00
#6 2.082 Collecting pytest-xdist
#6 2.099   Downloading http://packages/pytest-xdist/pytest_xdist-3.6.1-py3-none-any.whl (46 kB)
#6 2.110      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 46.1/46.1 kB 4.8 MB/s eta 0:00:00
#6 2.175 Collecting exceptiongroup>=1.0.0rc8
#6 2.193   Downloading http://packages/exceptiongroup/exceptiongroup-1.2.2-py3-none-any.whl (16 kB)
#6 2.252 Collecting tomli>=1
#6 2.269   Downloading http://packages/tomli/tomli-2.2.1-py3-none-any.whl (14 kB)
#6 2.333 Collecting packaging
#6 2.350   Downloading http://packages/packaging/packaging-24.2-py3-none-any.whl (65 kB)
#6 2.363      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 65.5/65.5 kB 6.7 MB/s eta 0:00:00
#6 2.390 Collecting iniconfig
#6 2.412   Downloading http://packages/iniconfig/iniconfig-2.0.0-py3-none-any.whl (5.9 kB)
#6 2.460 Collecting pluggy<2,>=1.5
#6 2.481   Downloading http://packages/pluggy/pluggy-1.5.0-py3-none-any.whl (20 kB)
#6 2.553 Collecting execnet>=2.1
#6 2.574   Downloading http://packages/execnet/execnet-2.1.1-py3-none-any.whl (40 kB)
#6 2.582      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 40.6/40.6 kB 7.8 MB/s eta 0:00:00
#6 2.703 Installing collected packages: tomli, pluggy, packaging, iniconfig, execnet, exceptiongroup, pytest, pytest-xdist
#6 3.250 Successfully installed exceptiongroup-1.2.2 execnet-2.1.1 iniconfig-2.0.0 packaging-24.2 pluggy-1.5.0 pytest-8.3.4 pytest-xdist-3.6.1 tomli-2.2.1
#6 3.251 WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv
#6 3.380 
#6 3.380 [notice] A new release of pip is available: 23.0.1 -> 24.3.1
#6 3.380 [notice] To update, run: pip install --upgrade pip
#6 4.212 Looking in indexes: http://simple/
#6 4.292 Collecting pipdeptree
#6 4.312   Downloading http://packages/pipdeptree/pipdeptree-2.24.0-py3-none-any.whl (32 kB)
#6 4.336 Requirement already satisfied: packaging>=24.1 in /usr/local/lib/python3.10/site-packages (from pipdeptree) (24.2)
#6 4.450 Collecting pip>=24.2
#6 4.461   Using cached http://packages/pip/pip-24.3.1-py3-none-any.whl (1.8 MB)
#6 4.581 Installing collected packages: pip, pipdeptree
#6 4.581   Attempting uninstall: pip
#6 4.582     Found existing installation: pip 23.0.1
#6 4.746     Uninstalling pip-23.0.1:
#6 4.957       Successfully uninstalled pip-23.0.1
#6 6.204 Successfully installed pip-24.3.1 pipdeptree-2.24.0
#6 6.205 WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv
#6 6.358 Cloning into 'prompt-poet'...
#6 8.336 Note: switching to '4664320754eb7789f69820ce6bd8108279524a44'.
#6 8.336 
#6 8.336 You are in 'detached HEAD' state. You can look around, make experimental
#6 8.336 changes and commit them, and you can discard any commits you make in this
#6 8.336 state without impacting any branches by switching back to a branch.
#6 8.336 
#6 8.336 If you want to create a new branch to retain commits you create, you may
#6 8.336 do so (now or later) by using -c with the switch command. Example:
#6 8.336 
#6 8.336   git switch -c <new-branch-name>
#6 8.336 
#6 8.336 Or undo this operation with:
#6 8.336 
#6 8.336   git switch -
#6 8.336 
#6 8.336 Turn off this advice by setting config variable advice.detachedHead to false
#6 8.336 
#6 8.336 HEAD is now at 4664320 add google-cloud-storage==2.19.0 as install_requires (#35)
#6 8.863 Looking in indexes: http://simple/
#6 8.864 Obtaining file:///repo
#6 8.866   Preparing metadata (setup.py): started
#6 9.564   Preparing metadata (setup.py): finished with status 'done'
#6 9.626 Collecting jinja2>=3.0.0 (from prompt-poet==0.0.42)
#6 9.644   Downloading http://packages/jinja2/jinja2-3.1.5-py3-none-any.whl (134 kB)
#6 9.749 Collecting PyYaml>=6.0.0 (from prompt-poet==0.0.42)
#6 9.767   Downloading http://packages/pyyaml/PyYAML-6.0.2-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (751 kB)
#6 9.796      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 751.2/751.2 kB 39.4 MB/s eta 0:00:00
#6 9.838 Collecting cachetools==5.3.3 (from prompt-poet==0.0.42)
#6 9.860   Downloading http://packages/cachetools/cachetools-5.3.3-py3-none-any.whl (9.3 kB)
#6 9.969 Collecting tiktoken==0.7.0 (from prompt-poet==0.0.42)
#6 9.987   Downloading http://packages/tiktoken/tiktoken-0.7.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (1.1 MB)
#6 10.02      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.1/1.1 MB 50.6 MB/s eta 0:00:00
#6 10.12 Collecting google-cloud-storage==2.19.0 (from prompt-poet==0.0.42)
#6 10.14   Downloading http://packages/google-cloud-storage/google_cloud_storage-2.19.0-py2.py3-none-any.whl (131 kB)
#6 10.32 Collecting google-auth<3.0dev,>=2.26.1 (from google-cloud-storage==2.19.0->prompt-poet==0.0.42)
#6 10.34   Downloading http://packages/google-auth/google_auth-2.37.0-py2.py3-none-any.whl (209 kB)
#6 10.48 Collecting google-api-core<3.0.0dev,>=2.15.0 (from google-cloud-storage==2.19.0->prompt-poet==0.0.42)
#6 10.50   Downloading http://packages/google-api-core/google_api_core-2.24.0-py3-none-any.whl (158 kB)
#6 10.58 Collecting google-cloud-core<3.0dev,>=2.3.0 (from google-cloud-storage==2.19.0->prompt-poet==0.0.42)
#6 10.60   Downloading http://packages/google-cloud-core/google_cloud_core-2.4.1-py2.py3-none-any.whl (29 kB)
#6 10.66 Collecting google-resumable-media>=2.7.2 (from google-cloud-storage==2.19.0->prompt-poet==0.0.42)
#6 10.68   Downloading http://packages/google-resumable-media/google_resumable_media-2.7.2-py2.py3-none-any.whl (81 kB)
#6 10.77 Collecting requests<3.0.0dev,>=2.18.0 (from google-cloud-storage==2.19.0->prompt-poet==0.0.42)
#6 10.77   Using cached http://packages/requests/requests-2.32.3-py3-none-any.whl (64 kB)
#6 10.88 Collecting google-crc32c<2.0dev,>=1.0 (from google-cloud-storage==2.19.0->prompt-poet==0.0.42)
#6 10.91   Downloading http://packages/google-crc32c/google_crc32c-1.6.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (37 kB)
#6 11.61 Collecting regex>=2022.1.18 (from tiktoken==0.7.0->prompt-poet==0.0.42)
#6 11.63   Downloading http://packages/regex/regex-2024.11.6-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (781 kB)
#6 11.66      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 781.7/781.7 kB 41.5 MB/s eta 0:00:00
#6 11.80 Collecting MarkupSafe>=2.0 (from jinja2>=3.0.0->prompt-poet==0.0.42)
#6 11.81   Downloading http://packages/markupsafe/MarkupSafe-3.0.2-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (20 kB)
#6 11.88 Collecting googleapis-common-protos<2.0.dev0,>=1.56.2 (from google-api-core<3.0.0dev,>=2.15.0->google-cloud-storage==2.19.0->prompt-poet==0.0.42)
#6 11.90   Downloading http://packages/googleapis-common-protos/googleapis_common_protos-1.66.0-py2.py3-none-any.whl (221 kB)
#6 12.56 Collecting protobuf!=3.20.0,!=3.20.1,!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<6.0.0.dev0,>=3.19.5 (from google-api-core<3.0.0dev,>=2.15.0->google-cloud-storage==2.19.0->prompt-poet==0.0.42)
#6 12.59   Downloading http://packages/protobuf/protobuf-5.29.2-cp38-abi3-manylinux2014_x86_64.whl (319 kB)
#6 12.65 Collecting proto-plus<2.0.0dev,>=1.22.3 (from google-api-core<3.0.0dev,>=2.15.0->google-cloud-storage==2.19.0->prompt-poet==0.0.42)
#6 12.67   Downloading http://packages/proto-plus/proto_plus-1.25.0-py3-none-any.whl (50 kB)
#6 12.76 Collecting pyasn1-modules>=0.2.1 (from google-auth<3.0dev,>=2.26.1->google-cloud-storage==2.19.0->prompt-poet==0.0.42)
#6 12.78   Downloading http://packages/pyasn1-modules/pyasn1_modules-0.4.1-py3-none-any.whl (181 kB)
#6 12.83 Collecting rsa<5,>=3.1.4 (from google-auth<3.0dev,>=2.26.1->google-cloud-storage==2.19.0->prompt-poet==0.0.42)
#6 12.85   Downloading http://packages/rsa/rsa-4.9-py3-none-any.whl (34 kB)
#6 13.10 Collecting charset-normalizer<4,>=2 (from requests<3.0.0dev,>=2.18.0->google-cloud-storage==2.19.0->prompt-poet==0.0.42)
#6 13.10   Using cached http://packages/charset-normalizer/charset_normalizer-3.4.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (146 kB)
#6 13.13 Collecting idna<4,>=2.5 (from requests<3.0.0dev,>=2.18.0->google-cloud-storage==2.19.0->prompt-poet==0.0.42)
#6 13.13   Using cached http://packages/idna/idna-3.10-py3-none-any.whl (70 kB)
#6 13.22 Collecting urllib3<3,>=1.21.1 (from requests<3.0.0dev,>=2.18.0->google-cloud-storage==2.19.0->prompt-poet==0.0.42)
#6 13.22   Using cached http://packages/urllib3/urllib3-2.3.0-py3-none-any.whl (128 kB)
#6 13.27 Collecting certifi>=2017.4.17 (from requests<3.0.0dev,>=2.18.0->google-cloud-storage==2.19.0->prompt-poet==0.0.42)
#6 13.27   Using cached http://packages/certifi/certifi-2024.12.14-py3-none-any.whl (164 kB)
#6 13.53 Collecting pyasn1<0.7.0,>=0.4.6 (from pyasn1-modules>=0.2.1->google-auth<3.0dev,>=2.26.1->google-cloud-storage==2.19.0->prompt-poet==0.0.42)
#6 13.55   Downloading http://packages/pyasn1/pyasn1-0.6.1-py3-none-any.whl (83 kB)
#6 13.68 Installing collected packages: urllib3, regex, PyYaml, pyasn1, protobuf, MarkupSafe, idna, google-crc32c, charset-normalizer, certifi, cachetools, rsa, requests, pyasn1-modules, proto-plus, jinja2, googleapis-common-protos, google-resumable-media, tiktoken, google-auth, google-api-core, google-cloud-core, google-cloud-storage, prompt-poet
#6 15.79   DEPRECATION: Legacy editable install of prompt-poet==0.0.42 from file:///repo (setup.py develop) is deprecated. pip 25.0 will enforce this behaviour change. A possible replacement is to add a pyproject.toml or enable --use-pep517, and use setuptools >= 64. If the resulting installation is not behaving as expected, try using --config-settings editable_mode=compat. Please consult the setuptools documentation for more information. Discussion can be found at https://github.com/pypa/pip/issues/11457
#6 15.79   Running setup.py develop for prompt-poet
#6 16.43 Successfully installed MarkupSafe-3.0.2 PyYaml-6.0.2 cachetools-5.3.3 certifi-2024.12.14 charset-normalizer-3.4.1 google-api-core-2.24.0 google-auth-2.37.0 google-cloud-core-2.4.1 google-cloud-storage-2.19.0 google-crc32c-1.6.0 google-resumable-media-2.7.2 googleapis-common-protos-1.66.0 idna-3.10 jinja2-3.1.5 prompt-poet proto-plus-1.25.0 protobuf-5.29.2 pyasn1-0.6.1 pyasn1-modules-0.4.1 regex-2024.11.6 requests-2.32.3 rsa-4.9 tiktoken-0.7.0 urllib3-2.3.0
#6 16.43 WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable.It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.
#6 DONE 17.1s

#7 [4/5] RUN cd /repo && pytest --collect-only -q
#7 6.236 tests/test_prompt.py::test_simple_prompt_sad
#7 6.236 tests/test_prompt.py::test_simple_prompt_happy
#7 6.236 tests/test_prompt.py::test_section_prompt_happy
#7 6.236 tests/test_prompt.py::test_macros_prompt_happy
#7 6.236 tests/test_prompt.py::test_function_prompt_happy
#7 6.236 tests/test_prompt.py::test_template_not_found
#7 6.236 tests/test_prompt.py::test_control_flow_happy
#7 6.236 tests/test_prompt.py::test_scanner_error
#7 6.236 tests/test_prompt.py::test_example_cai_template_happy
#7 6.236 tests/test_prompt.py::test_truncation_template_happy
#7 6.236 tests/test_prompt.py::test_escape_characters
#7 6.236 tests/test_prompt.py::test_truncation_failure
#7 6.236 tests/test_prompt.py::test_output_messages
#7 6.236 tests/test_prompt.py::test_truncate_before_tokenize
#7 6.236 tests/test_prompt.py::test_truncation_step_zero
#7 6.236 tests/test_prompt.py::test_tiktoken_encoding_name
#7 6.236 tests/test_prompt.py::test_reply_prompt
#7 6.236 tests/test_prompt.py::test_template_loader_with_prompt
#7 6.236 tests/test_template_loaders.py::test_gcs_dict_template_loader
#7 6.236 
#7 6.236 19 tests collected in 5.34s
#7 DONE 6.8s

#8 exporting to image
#8 exporting layers
#8 exporting layers 0.6s done
#8 writing image sha256:ed8bad5f265002575efe310a5951250aff2a8aa68228e8dc390c9959e4642fbd done
#8 naming to docker.io/library/tmp:tmp done
#8 DONE 0.6s
