#0 building with "default" instance using docker driver

#1 [internal] load build definition from Dockerfile
#1 transferring dockerfile: 1.11kB done
#1 DONE 0.0s

#2 [internal] load metadata for docker.io/library/python:3.10
#2 DONE 0.0s

#3 [internal] load .dockerignore
#3 transferring context: 2B done
#3 DONE 0.0s

#4 [1/6] FROM docker.io/library/python:3.10
#4 DONE 0.0s

#5 [2/6] RUN mkdir -p ~/.pip && touch ~/.pip/pip.conf &&     echo "[global]" >> ~/.pip/pip.conf && echo "index-url=http://simple/" >> ~/.pip/pip.conf && echo "[install]" >> ~/.pip/pip.conf && echo "trusted-host=pypi..org" >> ~/.pip/pip.conf &&     apt-get update && apt-get install -y curl &&     curl -sSL https://install.python-poetry.org | python -
#5 CACHED

#6 [3/6] RUN pip install pytest pytest-xdist &&     pip install pipdeptree &&     git clone https://github.com/google-deepmind/nanodo.git &&     mkdir /repo &&     git config --global --add safe.directory /repo &&     cp -r /nanodo/. /repo && rm -rf /nanodo/ &&     rm -rf /nanodo &&     cd /repo && git checkout 10aefdeed40a63293daf112b91a5538cd24fa3a4 &&     cd /repo && pip install flit==3.10.1
#6 1.755 Looking in indexes: http://simple/
#6 1.935 Collecting pytest
#6 1.953   Downloading http://packages/pytest/pytest-8.3.4-py3-none-any.whl (343 kB)
#6 1.978      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 343.1/343.1 kB 16.6 MB/s eta 0:00:00
#6 2.049 Collecting pytest-xdist
#6 2.068   Downloading http://packages/pytest-xdist/pytest_xdist-3.6.1-py3-none-any.whl (46 kB)
#6 2.080      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 46.1/46.1 kB 4.5 MB/s eta 0:00:00
#6 2.154 Collecting tomli>=1
#6 2.172   Downloading http://packages/tomli/tomli-2.2.1-py3-none-any.whl (14 kB)
#6 2.205 Collecting iniconfig
#6 2.222   Downloading http://packages/iniconfig/iniconfig-2.0.0-py3-none-any.whl (5.9 kB)
#6 2.267 Collecting exceptiongroup>=1.0.0rc8
#6 2.289   Downloading http://packages/exceptiongroup/exceptiongroup-1.2.2-py3-none-any.whl (16 kB)
#6 2.336 Collecting pluggy<2,>=1.5
#6 2.354   Downloading http://packages/pluggy/pluggy-1.5.0-py3-none-any.whl (20 kB)
#6 2.422 Collecting packaging
#6 2.440   Downloading http://packages/packaging/packaging-24.2-py3-none-any.whl (65 kB)
#6 2.452      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 65.5/65.5 kB 6.8 MB/s eta 0:00:00
#6 2.511 Collecting execnet>=2.1
#6 2.529   Downloading http://packages/execnet/execnet-2.1.1-py3-none-any.whl (40 kB)
#6 2.538      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 40.6/40.6 kB 7.6 MB/s eta 0:00:00
#6 2.674 Installing collected packages: tomli, pluggy, packaging, iniconfig, execnet, exceptiongroup, pytest, pytest-xdist
#6 3.213 Successfully installed exceptiongroup-1.2.2 execnet-2.1.1 iniconfig-2.0.0 packaging-24.2 pluggy-1.5.0 pytest-8.3.4 pytest-xdist-3.6.1 tomli-2.2.1
#6 3.214 WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv
#6 3.337 
#6 3.337 [notice] A new release of pip is available: 23.0.1 -> 24.3.1
#6 3.337 [notice] To update, run: pip install --upgrade pip
#6 4.036 Looking in indexes: http://simple/
#6 4.120 Collecting pipdeptree
#6 4.142   Downloading http://packages/pipdeptree/pipdeptree-2.24.0-py3-none-any.whl (32 kB)
#6 4.167 Requirement already satisfied: packaging>=24.1 in /usr/local/lib/python3.10/site-packages (from pipdeptree) (24.2)
#6 4.287 Collecting pip>=24.2
#6 4.298   Using cached http://packages/pip/pip-24.3.1-py3-none-any.whl (1.8 MB)
#6 4.424 Installing collected packages: pip, pipdeptree
#6 4.424   Attempting uninstall: pip
#6 4.425     Found existing installation: pip 23.0.1
#6 4.596     Uninstalling pip-23.0.1:
#6 4.767       Successfully uninstalled pip-23.0.1
#6 6.135 Successfully installed pip-24.3.1 pipdeptree-2.24.0
#6 6.136 WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv
#6 6.351 Cloning into 'nanodo'...
#6 8.436 Note: switching to '10aefdeed40a63293daf112b91a5538cd24fa3a4'.
#6 8.436 
#6 8.436 You are in 'detached HEAD' state. You can look around, make experimental
#6 8.436 changes and commit them, and you can discard any commits you make in this
#6 8.436 state without impacting any branches by switching back to a branch.
#6 8.436 
#6 8.436 If you want to create a new branch to retain commits you create, you may
#6 8.436 do so (now or later) by using -c with the switch command. Example:
#6 8.436 
#6 8.436   git switch -c <new-branch-name>
#6 8.436 
#6 8.436 Or undo this operation with:
#6 8.436 
#6 8.436   git switch -
#6 8.436 
#6 8.436 Turn off this advice by setting config variable advice.detachedHead to false
#6 8.436 
#6 8.436 HEAD is now at 10aefde No public description
#6 8.988 Looking in indexes: http://simple/
#6 9.037 Collecting flit==3.10.1
#6 9.054   Downloading http://packages/flit/flit-3.10.1-py3-none-any.whl (50 kB)
#6 9.109 Collecting flit_core>=3.10.1 (from flit==3.10.1)
#6 9.127   Downloading http://packages/flit-core/flit_core-3.10.1-py3-none-any.whl (36 kB)
#6 9.198 Collecting requests (from flit==3.10.1)
#6 9.201   Using cached http://packages/requests/requests-2.32.3-py3-none-any.whl (64 kB)
#6 9.245 Collecting docutils (from flit==3.10.1)
#6 9.267   Downloading http://packages/docutils/docutils-0.21.2-py3-none-any.whl (587 kB)
#6 9.324      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 587.4/587.4 kB 29.7 MB/s eta 0:00:00
#6 9.349 Collecting tomli-w (from flit==3.10.1)
#6 9.367   Downloading http://packages/tomli-w/tomli_w-1.1.0-py3-none-any.whl (6.4 kB)
#6 9.376 Requirement already satisfied: pip in /usr/local/lib/python3.10/site-packages (from flit==3.10.1) (24.3.1)
#6 9.553 Collecting charset-normalizer<4,>=2 (from requests->flit==3.10.1)
#6 9.555   Using cached http://packages/charset-normalizer/charset_normalizer-3.4.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (146 kB)
#6 9.590 Collecting idna<4,>=2.5 (from requests->flit==3.10.1)
#6 9.593   Using cached http://packages/idna/idna-3.10-py3-none-any.whl (70 kB)
#6 9.684 Collecting urllib3<3,>=1.21.1 (from requests->flit==3.10.1)
#6 9.688   Using cached http://packages/urllib3/urllib3-2.3.0-py3-none-any.whl (128 kB)
#6 9.735 Collecting certifi>=2017.4.17 (from requests->flit==3.10.1)
#6 9.738   Using cached http://packages/certifi/certifi-2024.12.14-py3-none-any.whl (164 kB)
#6 9.798 Installing collected packages: urllib3, tomli-w, idna, flit_core, docutils, charset-normalizer, certifi, requests, flit
#6 10.67 Successfully installed certifi-2024.12.14 charset-normalizer-3.4.1 docutils-0.21.2 flit-3.10.1 flit_core-3.10.1 idna-3.10 requests-2.32.3 tomli-w-1.1.0 urllib3-2.3.0
#6 10.68 WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable.It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.
#6 DONE 11.1s

#7 [4/6] RUN cd /repo && flit install
#7 0.872 Fetching list of valid trove classifiers               I-flit.validate
#7 1.598 Extras to install for deps 'all': {'.none', 'test'}     I-flit.install
#7 2.140 Looking in indexes: http://simple/
#7 2.141 Processing /repo
#7 2.144   Installing build dependencies: started
#7 2.941   Installing build dependencies: finished with status 'done'
#7 2.942   Getting requirements to build wheel: started
#7 3.065   Getting requirements to build wheel: finished with status 'done'
#7 3.067   Preparing metadata (pyproject.toml): started
#7 3.197   Preparing metadata (pyproject.toml): finished with status 'done'
#7 3.242 Collecting absl-py>=2.1.0 (from nanodo==0.0.1)
#7 3.260   Downloading http://packages/absl-py/absl_py-2.1.0-py3-none-any.whl (133 kB)
#7 3.309 Collecting clu>=0.0.12 (from nanodo==0.0.1)
#7 3.330   Downloading http://packages/clu/clu-0.0.12-py3-none-any.whl (101 kB)
#7 3.397 Collecting flax>=0.8.2 (from nanodo==0.0.1)
#7 3.417   Downloading http://packages/flax/flax-0.10.2-py3-none-any.whl (424 kB)
#7 3.491 Collecting grain>=0.1.0 (from nanodo==0.0.1)
#7 3.638   Downloading http://packages/grain/grain-0.2.3-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (433 kB)
#7 3.761 Collecting jax>=0.4.26 (from nanodo==0.0.1)
#7 3.780   Downloading http://packages/jax/jax-0.4.38-py3-none-any.whl (2.2 MB)
#7 3.822      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 2.2/2.2 MB 79.0 MB/s eta 0:00:00
#7 3.935 Collecting jaxlib>=0.4.26 (from nanodo==0.0.1)
#7 3.957   Downloading http://packages/jaxlib/jaxlib-0.4.38-cp310-cp310-manylinux2014_x86_64.whl (101.7 MB)
#7 4.494      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 101.7/101.7 MB 195.4 MB/s eta 0:00:00
#7 4.837 Collecting ml-collections>=0.1.1 (from nanodo==0.0.1)
#7 4.857   Downloading http://packages/ml-collections/ml_collections-1.0.0-py3-none-any.whl (76 kB)
#7 5.243 Collecting numpy>=1.26.0 (from nanodo==0.0.1)
#7 5.270   Downloading http://packages/numpy/numpy-2.2.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (16.4 MB)
#7 5.376      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 16.4/16.4 MB 181.2 MB/s eta 0:00:00
#7 5.472 Collecting optax>=0.2.2 (from nanodo==0.0.1)
#7 5.558   Downloading http://packages/optax/optax-0.2.4-py3-none-any.whl (319 kB)
#7 5.629 Collecting orbax>=0.1.7 (from nanodo==0.0.1)
#7 5.735   Downloading http://packages/orbax/orbax-0.1.9.tar.gz (1.6 kB)
#7 5.747   Preparing metadata (setup.py): started
#7 6.534   Preparing metadata (setup.py): finished with status 'done'
#7 6.641 Collecting sentencepiece>=0.2.0 (from nanodo==0.0.1)
#7 6.671   Downloading http://packages/sentencepiece/sentencepiece-0.2.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (1.3 MB)
#7 6.706      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.3/1.3 MB 55.6 MB/s eta 0:00:00
#7 6.834 Collecting tensorflow_datasets>=4.9.5 (from nanodo==0.0.1)
#7 7.044   Downloading http://packages/tensorflow-datasets/tensorflow_datasets-4.9.7-py3-none-any.whl (5.3 MB)
#7 7.124      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 5.3/5.3 MB 79.5 MB/s eta 0:00:00
#7 7.521 Collecting tensorflow>=2.16.1 (from nanodo==0.0.1)
#7 7.541   Downloading http://packages/tensorflow/tensorflow-2.18.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (615.3 MB)
#7 12.62      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 615.3/615.3 MB 67.1 MB/s eta 0:00:00
#7 14.84 Collecting chex>=0.1.86 (from nanodo==0.0.1)
#7 14.87   Downloading http://packages/chex/chex-0.1.88-py3-none-any.whl (99 kB)
#7 14.94 Collecting typing_extensions>=4.2.0 (from chex>=0.1.86->nanodo==0.0.1)
#7 14.96   Downloading http://packages/typing-extensions/typing_extensions-4.12.2-py3-none-any.whl (37 kB)
#7 15.02 Collecting toolz>=0.9.0 (from chex>=0.1.86->nanodo==0.0.1)
#7 15.04   Downloading http://packages/toolz/toolz-1.0.0-py3-none-any.whl (56 kB)
#7 15.09 Collecting etils[epath] (from clu>=0.0.12->nanodo==0.0.1)
#7 15.11   Downloading http://packages/etils/etils-1.11.0-py3-none-any.whl (165 kB)
#7 15.17 Requirement already satisfied: packaging in /usr/local/lib/python3.10/site-packages (from clu>=0.0.12->nanodo==0.0.1) (24.2)
#7 15.36 Collecting wrapt (from clu>=0.0.12->nanodo==0.0.1)
#7 15.38   Downloading http://packages/wrapt/wrapt-1.17.0-cp310-cp310-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl (82 kB)
#7 15.54 Collecting msgpack (from flax>=0.8.2->nanodo==0.0.1)
#7 15.54   Using cached http://packages/msgpack/msgpack-1.1.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (378 kB)
#7 15.60 Collecting orbax-checkpoint (from flax>=0.8.2->nanodo==0.0.1)
#7 15.64   Downloading http://packages/orbax-checkpoint/orbax_checkpoint-0.11.0-py3-none-any.whl (360 kB)
#7 15.84 Collecting tensorstore (from flax>=0.8.2->nanodo==0.0.1)
#7 15.98   Downloading http://packages/tensorstore/tensorstore-0.1.71-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (17.8 MB)
#7 16.09      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 17.8/17.8 MB 184.2 MB/s eta 0:00:00
#7 16.31 Collecting rich>=11.1 (from flax>=0.8.2->nanodo==0.0.1)
#7 16.33   Downloading http://packages/rich/rich-13.9.4-py3-none-any.whl (242 kB)
#7 16.45 Collecting PyYAML>=5.4.1 (from flax>=0.8.2->nanodo==0.0.1)
#7 16.47   Downloading http://packages/pyyaml/PyYAML-6.0.2-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (751 kB)
#7 16.50      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 751.2/751.2 kB 36.1 MB/s eta 0:00:00
#7 16.54 Collecting array-record (from grain>=0.1.0->nanodo==0.0.1)
#7 16.56   Downloading http://packages/array-record/array_record-0.6.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (2.3 MB)
#7 16.61      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 2.3/2.3 MB 69.0 MB/s eta 0:00:00
#7 16.66 Collecting cloudpickle (from grain>=0.1.0->nanodo==0.0.1)
#7 16.68   Downloading http://packages/cloudpickle/cloudpickle-3.1.0-py3-none-any.whl (22 kB)
#7 16.72 Collecting dm-tree (from grain>=0.1.0->nanodo==0.0.1)
#7 16.75   Downloading http://packages/dm-tree/dm_tree-0.1.8-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (152 kB)
#7 16.81 Collecting jaxtyping (from grain>=0.1.0->nanodo==0.0.1)
#7 16.83   Downloading http://packages/jaxtyping/jaxtyping-0.2.36-py3-none-any.whl (55 kB)
#7 16.88 Collecting more-itertools>=9.1.0 (from grain>=0.1.0->nanodo==0.0.1)
#7 16.89   Using cached http://packages/more-itertools/more_itertools-10.5.0-py3-none-any.whl (60 kB)
#7 16.95 Collecting ml_dtypes>=0.4.0 (from jax>=0.4.26->nanodo==0.0.1)
#7 16.97   Downloading http://packages/ml-dtypes/ml_dtypes-0.5.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (4.7 MB)
#7 17.02      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 4.7/4.7 MB 119.7 MB/s eta 0:00:00
#7 17.08 Collecting opt_einsum (from jax>=0.4.26->nanodo==0.0.1)
#7 17.10   Downloading http://packages/opt-einsum/opt_einsum-3.4.0-py3-none-any.whl (71 kB)
#7 17.36 Collecting scipy>=1.10 (from jax>=0.4.26->nanodo==0.0.1)
#7 17.38   Downloading http://packages/scipy/scipy-1.15.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (40.6 MB)
#7 17.63      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 40.6/40.6 MB 174.0 MB/s eta 0:00:00
#7 17.83 Collecting six (from ml-collections>=0.1.1->nanodo==0.0.1)
#7 17.85   Downloading http://packages/six/six-1.17.0-py2.py3-none-any.whl (11 kB)
#7 17.92 Collecting astunparse>=1.6.0 (from tensorflow>=2.16.1->nanodo==0.0.1)
#7 17.94   Downloading http://packages/astunparse/astunparse-1.6.3-py2.py3-none-any.whl (12 kB)
#7 17.98 Collecting flatbuffers>=24.3.25 (from tensorflow>=2.16.1->nanodo==0.0.1)
#7 17.99   Downloading http://packages/flatbuffers/flatbuffers-24.12.23-py2.py3-none-any.whl (30 kB)
#7 18.03 Collecting gast!=0.5.0,!=0.5.1,!=0.5.2,>=0.2.1 (from tensorflow>=2.16.1->nanodo==0.0.1)
#7 18.05   Downloading http://packages/gast/gast-0.6.0-py3-none-any.whl (21 kB)
#7 18.08 Collecting google-pasta>=0.1.1 (from tensorflow>=2.16.1->nanodo==0.0.1)
#7 18.11   Downloading http://packages/google-pasta/google_pasta-0.2.0-py3-none-any.whl (57 kB)
#7 18.15 Collecting libclang>=13.0.0 (from tensorflow>=2.16.1->nanodo==0.0.1)
#7 18.17   Downloading http://packages/libclang/libclang-18.1.1-py2.py3-none-manylinux2010_x86_64.whl (24.5 MB)
#7 18.31      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 24.5/24.5 MB 199.6 MB/s eta 0:00:00
#7 18.91 Collecting protobuf!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<6.0.0dev,>=3.20.3 (from tensorflow>=2.16.1->nanodo==0.0.1)
#7 18.93   Downloading http://packages/protobuf/protobuf-5.29.2-cp38-abi3-manylinux2014_x86_64.whl (319 kB)
#7 18.96 Requirement already satisfied: requests<3,>=2.21.0 in /usr/local/lib/python3.10/site-packages (from tensorflow>=2.16.1->nanodo==0.0.1) (2.32.3)
#7 18.96 Requirement already satisfied: setuptools in /usr/local/lib/python3.10/site-packages (from tensorflow>=2.16.1->nanodo==0.0.1) (65.5.1)
#7 18.98 Collecting termcolor>=1.1.0 (from tensorflow>=2.16.1->nanodo==0.0.1)
#7 19.01   Downloading http://packages/termcolor/termcolor-2.5.0-py3-none-any.whl (7.8 kB)
#7 20.14 Collecting grpcio<2.0,>=1.24.3 (from tensorflow>=2.16.1->nanodo==0.0.1)
#7 20.16   Downloading http://packages/grpcio/grpcio-1.69.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (6.0 MB)
#7 20.22      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 6.0/6.0 MB 123.2 MB/s eta 0:00:00
#7 20.31 Collecting tensorboard<2.19,>=2.18 (from tensorflow>=2.16.1->nanodo==0.0.1)
#7 20.33   Downloading http://packages/tensorboard/tensorboard-2.18.0-py3-none-any.whl (5.5 MB)
#7 20.39      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 5.5/5.5 MB 122.1 MB/s eta 0:00:00
#7 20.47 Collecting keras>=3.5.0 (from tensorflow>=2.16.1->nanodo==0.0.1)
#7 20.50   Downloading http://packages/keras/keras-3.8.0-py3-none-any.whl (1.3 MB)
#7 20.53      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.3/1.3 MB 58.3 MB/s eta 0:00:00
#7 20.56 Collecting numpy>=1.26.0 (from nanodo==0.0.1)
#7 20.58   Downloading http://packages/numpy/numpy-2.0.2-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (19.5 MB)
#7 20.73      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 19.5/19.5 MB 142.9 MB/s eta 0:00:00
#7 20.90 Collecting h5py>=3.11.0 (from tensorflow>=2.16.1->nanodo==0.0.1)
#7 20.92   Downloading http://packages/h5py/h5py-3.12.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (5.3 MB)
#7 20.98      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 5.3/5.3 MB 127.4 MB/s eta 0:00:00
#7 21.01 Collecting ml_dtypes>=0.4.0 (from jax>=0.4.26->nanodo==0.0.1)
#7 21.03   Downloading http://packages/ml-dtypes/ml_dtypes-0.4.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (2.2 MB)
#7 21.07      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 2.2/2.2 MB 77.0 MB/s eta 0:00:00
#7 21.15 Collecting tensorflow-io-gcs-filesystem>=0.23.1 (from tensorflow>=2.16.1->nanodo==0.0.1)
#7 21.17   Downloading http://packages/tensorflow-io-gcs-filesystem/tensorflow_io_gcs_filesystem-0.37.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (5.1 MB)
#7 21.23      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 5.1/5.1 MB 130.6 MB/s eta 0:00:00
#7 21.30 Collecting click (from tensorflow_datasets>=4.9.5->nanodo==0.0.1)
#7 21.32   Downloading http://packages/click/click-8.1.8-py3-none-any.whl (98 kB)
#7 21.36 Collecting immutabledict (from tensorflow_datasets>=4.9.5->nanodo==0.0.1)
#7 21.38   Downloading http://packages/immutabledict/immutabledict-4.2.1-py3-none-any.whl (4.7 kB)
#7 21.41 Collecting promise (from tensorflow_datasets>=4.9.5->nanodo==0.0.1)
#7 21.44   Downloading http://packages/promise/promise-2.3.tar.gz (19 kB)
#7 21.46   Preparing metadata (setup.py): started
#7 21.85   Preparing metadata (setup.py): finished with status 'done'
#7 22.10 Collecting psutil (from tensorflow_datasets>=4.9.5->nanodo==0.0.1)
#7 22.12   Downloading http://packages/psutil/psutil-6.1.1-cp36-abi3-manylinux_2_12_x86_64.manylinux2010_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl (287 kB)
#7 22.32 Collecting pyarrow (from tensorflow_datasets>=4.9.5->nanodo==0.0.1)
#7 22.34   Downloading http://packages/pyarrow/pyarrow-18.1.0-cp310-cp310-manylinux_2_28_x86_64.whl (40.1 MB)
#7 22.54      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 40.1/40.1 MB 219.1 MB/s eta 0:00:00
#7 22.73 Collecting simple-parsing (from tensorflow_datasets>=4.9.5->nanodo==0.0.1)
#7 22.75   Downloading http://packages/simple-parsing/simple_parsing-0.1.6-py3-none-any.whl (112 kB)
#7 22.80 Collecting tensorflow-metadata (from tensorflow_datasets>=4.9.5->nanodo==0.0.1)
#7 22.82   Downloading http://packages/tensorflow-metadata/tensorflow_metadata-1.16.1-py3-none-any.whl (28 kB)
#7 22.85 Collecting toml (from tensorflow_datasets>=4.9.5->nanodo==0.0.1)
#7 22.87   Downloading http://packages/toml/toml-0.10.2-py2.py3-none-any.whl (16 kB)
#7 22.99 Collecting tqdm (from tensorflow_datasets>=4.9.5->nanodo==0.0.1)
#7 23.01   Downloading http://packages/tqdm/tqdm-4.67.1-py3-none-any.whl (78 kB)
#7 23.04 Requirement already satisfied: wheel<1.0,>=0.23.0 in /usr/local/lib/python3.10/site-packages (from astunparse>=1.6.0->tensorflow>=2.16.1->nanodo==0.0.1) (0.45.1)
#7 23.10 Collecting fsspec (from etils[edc,enp,epath,epy,etree]>=1.6.0; python_version < "3.11"->tensorflow_datasets>=4.9.5->nanodo==0.0.1)
#7 23.12   Downloading http://packages/fsspec/fsspec-2024.12.0-py3-none-any.whl (183 kB)
#7 23.26 Collecting importlib_resources (from etils[edc,enp,epath,epy,etree]>=1.6.0; python_version < "3.11"->tensorflow_datasets>=4.9.5->nanodo==0.0.1)
#7 23.28   Downloading http://packages/importlib-resources/importlib_resources-6.5.2-py3-none-any.whl (37 kB)
#7 23.34 Collecting zipp (from etils[edc,enp,epath,epy,etree]>=1.6.0; python_version < "3.11"->tensorflow_datasets>=4.9.5->nanodo==0.0.1)
#7 23.34   Using cached http://packages/zipp/zipp-3.21.0-py3-none-any.whl (9.6 kB)
#7 23.40 Collecting namex (from keras>=3.5.0->tensorflow>=2.16.1->nanodo==0.0.1)
#7 23.42   Downloading http://packages/namex/namex-0.0.8-py3-none-any.whl (5.8 kB)
#7 23.57 Collecting optree (from keras>=3.5.0->tensorflow>=2.16.1->nanodo==0.0.1)
#7 23.59   Downloading http://packages/optree/optree-0.13.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (381 kB)
#7 23.74 Collecting nest_asyncio (from orbax-checkpoint->flax>=0.8.2->nanodo==0.0.1)
#7 23.75   Downloading http://packages/nest-asyncio/nest_asyncio-1.6.0-py3-none-any.whl (5.2 kB)
#7 23.80 Collecting humanize (from orbax-checkpoint->flax>=0.8.2->nanodo==0.0.1)
#7 23.82   Downloading http://packages/humanize/humanize-4.11.0-py3-none-any.whl (128 kB)
#7 24.03 Collecting simplejson>=3.16.0 (from orbax-checkpoint->flax>=0.8.2->nanodo==0.0.1)
#7 24.05   Downloading http://packages/simplejson/simplejson-3.19.3-cp310-cp310-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl (137 kB)
#7 24.08 Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.10/site-packages (from requests<3,>=2.21.0->tensorflow>=2.16.1->nanodo==0.0.1) (3.4.1)
#7 24.08 Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/site-packages (from requests<3,>=2.21.0->tensorflow>=2.16.1->nanodo==0.0.1) (3.10)
#7 24.08 Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.10/site-packages (from requests<3,>=2.21.0->tensorflow>=2.16.1->nanodo==0.0.1) (2.3.0)
#7 24.08 Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/site-packages (from requests<3,>=2.21.0->tensorflow>=2.16.1->nanodo==0.0.1) (2024.12.14)
#7 24.13 Collecting markdown-it-py>=2.2.0 (from rich>=11.1->flax>=0.8.2->nanodo==0.0.1)
#7 24.15   Downloading http://packages/markdown-it-py/markdown_it_py-3.0.0-py3-none-any.whl (87 kB)
#7 24.24 Collecting pygments<3.0.0,>=2.13.0 (from rich>=11.1->flax>=0.8.2->nanodo==0.0.1)
#7 24.26   Downloading http://packages/pygments/pygments-2.19.1-py3-none-any.whl (1.2 MB)
#7 24.29      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.2/1.2 MB 50.8 MB/s eta 0:00:00
#7 24.61 Collecting markdown>=2.6.8 (from tensorboard<2.19,>=2.18->tensorflow>=2.16.1->nanodo==0.0.1)
#7 24.62   Downloading http://packages/markdown/Markdown-3.7-py3-none-any.whl (106 kB)
#7 24.79 Collecting tensorboard-data-server<0.8.0,>=0.7.0 (from tensorboard<2.19,>=2.18->tensorflow>=2.16.1->nanodo==0.0.1)
#7 24.81   Downloading http://packages/tensorboard-data-server/tensorboard_data_server-0.7.2-py3-none-manylinux_2_31_x86_64.whl (6.6 MB)
#7 24.87      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 6.6/6.6 MB 143.3 MB/s eta 0:00:00
#7 24.95 Collecting werkzeug>=1.0.1 (from tensorboard<2.19,>=2.18->tensorflow>=2.16.1->nanodo==0.0.1)
#7 24.97   Downloading http://packages/werkzeug/werkzeug-3.1.3-py3-none-any.whl (224 kB)
#7 25.12 Collecting docstring-parser<1.0,>=0.15 (from simple-parsing->tensorflow_datasets>=4.9.5->nanodo==0.0.1)
#7 25.14   Downloading http://packages/docstring-parser/docstring_parser-0.16-py3-none-any.whl (36 kB)
#7 25.23 Collecting protobuf!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<6.0.0dev,>=3.20.3 (from tensorflow>=2.16.1->nanodo==0.0.1)
#7 25.25   Downloading http://packages/protobuf/protobuf-3.20.3-cp310-cp310-manylinux_2_12_x86_64.manylinux2010_x86_64.whl (1.1 MB)
#7 25.28      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.1/1.1 MB 46.5 MB/s eta 0:00:00
#7 25.36 Collecting mdurl~=0.1 (from markdown-it-py>=2.2.0->rich>=11.1->flax>=0.8.2->nanodo==0.0.1)
#7 25.38   Downloading http://packages/mdurl/mdurl-0.1.2-py3-none-any.whl (10.0 kB)
#7 25.53 Collecting MarkupSafe>=2.1.1 (from werkzeug>=1.0.1->tensorboard<2.19,>=2.18->tensorflow>=2.16.1->nanodo==0.0.1)
#7 25.55   Downloading http://packages/markupsafe/MarkupSafe-3.0.2-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (20 kB)
#7 25.62 Building wheels for collected packages: nanodo, orbax, promise
#7 25.63   Building wheel for nanodo (pyproject.toml): started
#7 25.76   Building wheel for nanodo (pyproject.toml): finished with status 'done'
#7 25.76   Created wheel for nanodo: filename=nanodo-0.0.1-py3-none-any.whl size=31225 sha256=025852a886feb91b1e332b172ed693f187929e9d60c60fb97bd1974b8e8128da
#7 25.76   Stored in directory: /tmp/pip-ephem-wheel-cache-wak0muo2/wheels/83/05/69/977b54e69478800cfcea8a9437a7ea4a9b1a48db334f824611
#7 25.76   Building wheel for orbax (setup.py): started
#7 26.52   Building wheel for orbax (setup.py): finished with status 'done'
#7 26.52   Created wheel for orbax: filename=orbax-0.1.9-py3-none-any.whl size=1497 sha256=d63458ec43780e3a98405b0eebfe87e845b06b02a93ec978ee8fb8e5075b7764
#7 26.52   Stored in directory: /root/.cache/pip/wheels/8b/63/1a/0dccf1a417c2aa2f867d613ee705f768b7314a1377de4e06a7
#7 26.52   Building wheel for promise (setup.py): started
#7 27.04   Building wheel for promise (setup.py): finished with status 'done'
#7 27.04   Created wheel for promise: filename=promise-2.3-py3-none-any.whl size=21484 sha256=023002a759b97bb3de35eef89e9689fb06849e35e664a738d545a57e59d93bff
#7 27.04   Stored in directory: /root/.cache/pip/wheels/c5/2b/e0/7357da31eb4315af243ea10fb0ff75f09c39dfebfcb92499a9
#7 27.04 Successfully built nanodo orbax promise
#7 27.73 Installing collected packages: sentencepiece, namex, libclang, flatbuffers, dm-tree, zipp, wrapt, typing_extensions, tqdm, toolz, toml, termcolor, tensorflow-io-gcs-filesystem, tensorboard-data-server, six, simplejson, PyYAML, pygments, pyarrow, psutil, protobuf, opt_einsum, numpy, nest_asyncio, msgpack, more-itertools, mdurl, MarkupSafe, markdown, jaxtyping, importlib_resources, immutabledict, humanize, grpcio, gast, fsspec, etils, docstring-parser, cloudpickle, click, absl-py, werkzeug, tensorflow-metadata, simple-parsing, scipy, promise, optree, ml_dtypes, ml-collections, markdown-it-py, h5py, google-pasta, astunparse, tensorstore, tensorboard, rich, jaxlib, keras, jax, array-record, tensorflow, orbax-checkpoint, grain, chex, tensorflow_datasets, orbax, optax, flax, clu, nanodo
#7 76.47 Successfully installed MarkupSafe-3.0.2 PyYAML-6.0.2 absl-py-2.1.0 array-record-0.6.0 astunparse-1.6.3 chex-0.1.88 click-8.1.8 cloudpickle-3.1.0 clu-0.0.12 dm-tree-0.1.8 docstring-parser-0.16 etils-1.11.0 flatbuffers-24.12.23 flax-0.10.2 fsspec-2024.12.0 gast-0.6.0 google-pasta-0.2.0 grain-0.2.3 grpcio-1.69.0 h5py-3.12.1 humanize-4.11.0 immutabledict-4.2.1 importlib_resources-6.5.2 jax-0.4.38 jaxlib-0.4.38 jaxtyping-0.2.36 keras-3.8.0 libclang-18.1.1 markdown-3.7 markdown-it-py-3.0.0 mdurl-0.1.2 ml-collections-1.0.0 ml_dtypes-0.4.1 more-itertools-10.5.0 msgpack-1.1.0 namex-0.0.8 nanodo-0.0.1 nest_asyncio-1.6.0 numpy-2.0.2 opt_einsum-3.4.0 optax-0.2.4 optree-0.13.1 orbax-0.1.9 orbax-checkpoint-0.11.0 promise-2.3 protobuf-3.20.3 psutil-6.1.1 pyarrow-18.1.0 pygments-2.19.1 rich-13.9.4 scipy-1.15.0 sentencepiece-0.2.0 simple-parsing-0.1.6 simplejson-3.19.3 six-1.17.0 tensorboard-2.18.0 tensorboard-data-server-0.7.2 tensorflow-2.18.0 tensorflow-io-gcs-filesystem-0.37.1 tensorflow-metadata-1.16.1 tensorflow_datasets-4.9.7 tensorstore-0.1.71 termcolor-2.5.0 toml-0.10.2 toolz-1.0.0 tqdm-4.67.1 typing_extensions-4.12.2 werkzeug-3.1.3 wrapt-1.17.0 zipp-3.21.0
#7 76.47 WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable.It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.
#7 DONE 79.9s

#8 [5/6] RUN cd /repo && pytest --collect-only -q
#8 6.612 tests/data_test.py::DataTest::test_get_in_out
#8 6.612 tests/data_test.py::DataTest::test_py_batched_tfds
#8 6.612 tests/data_test.py::DataTest::test_py_batched_tfds_noam_packed
#8 6.612 tests/data_test.py::DataTest::test_py_batched_tfds_padded
#8 6.612 tests/data_test.py::DataTest::test_py_noam_pack
#8 6.612 tests/data_test.py::DataTest::test_py_tokenize
#8 6.612 tests/evaluate_test.py::EvalTest::test_eval_step
#8 6.612 tests/metrics_test.py::MetricsTest::test_aggregate_microbatch_metrics
#8 6.612 tests/metrics_test.py::MetricsTest::test_gaussian
#8 6.612 tests/metrics_test.py::MetricsTest::test_welford_mean_large_array
#8 6.612 tests/metrics_test.py::MetricsTest::test_welford_mean_large_pytree
#8 6.612 tests/model_factory_test.py::ModelTest::test_default_model
#8 6.612 tests/model_test.py::ModelTest::test_causality_beginning__with_jit
#8 6.612 tests/model_test.py::ModelTest::test_causality_beginning__without_jit
#8 6.612 tests/model_test.py::ModelTest::test_causality_near-beginning__with_jit
#8 6.612 tests/model_test.py::ModelTest::test_causality_near-beginning__without_jit
#8 6.612 tests/model_test.py::ModelTest::test_causality_near-end__with_jit
#8 6.612 tests/model_test.py::ModelTest::test_causality_near-end__without_jit
#8 6.612 tests/model_test.py::ModelTest::test_full_model__with_jit
#8 6.612 tests/model_test.py::ModelTest::test_full_model__without_jit
#8 6.612 tests/model_test.py::ModelTest::test_heads_divides_dimension
#8 6.612 tests/model_test.py::ModelTest::test_mlp__with_jit
#8 6.612 tests/model_test.py::ModelTest::test_mlp__without_jit
#8 6.612 tests/model_test.py::ModelTest::test_remat_forward__with_jit
#8 6.612 tests/model_test.py::ModelTest::test_remat_forward__without_jit
#8 6.612 tests/optimizer_test.py::OptimizerTest::test_create_lr0
#8 6.612 tests/optimizer_test.py::OptimizerTest::test_create_lr1
#8 6.612 tests/optimizer_test.py::OptimizerTest::test_create_lr_no_warmup
#8 6.612 tests/optimizer_test.py::OptimizerTest::test_scale_by_dict
#8 6.612 tests/train_test.py::TrainTest::test_train_and_evaluate0
#8 6.612 tests/train_test.py::TrainTest::test_train_and_evaluate1
#8 6.612 tests/train_test.py::TrainTest::test_train_step
#8 6.612 tests/train_test.py::TrainTest::test_train_step_remat
#8 6.612 tests/train_test.py::TrainTest::test_trainer0
#8 6.612 tests/train_test.py::TrainTest::test_trainer1
#8 6.612 
#8 6.612 35 tests collected in 5.61s
#8 DONE 8.2s

#9 exporting to image
#9 exporting layers
#9 exporting layers 23.1s done
#9 writing image sha256:dd6453e6dfd9bd4d5918bcac2c7607ffab9be9607c94462b31392d65e25f8c58 done
#9 naming to docker.io/library/tmp:tmp done
#9 DONE 23.1s
