tests/test_fim_tokenizer.py::test_encode_fim
tests/test_integration_samples.py::test_samples[v1-get_weather_full]
tests/test_integration_samples.py::test_samples[v1-get_weather_no_history]
tests/test_integration_samples.py::test_samples[v1-several_calls]
tests/test_integration_samples.py::test_samples[v1-no_tools]
tests/test_integration_samples.py::test_samples[v1-get_weather_no_system_prompt]
tests/test_integration_samples.py::test_samples[v1-parallel_calls]
tests/test_integration_samples.py::test_samples[v2-get_weather_full]
tests/test_integration_samples.py::test_samples[v2-get_weather_no_history]
tests/test_integration_samples.py::test_samples[v2-several_calls]
tests/test_integration_samples.py::test_samples[v2-no_tools]
tests/test_integration_samples.py::test_samples[v2-get_weather_no_system_prompt]
tests/test_integration_samples.py::test_samples[v2-parallel_calls]
tests/test_integration_samples.py::test_samples[v3-get_weather_full]
tests/test_integration_samples.py::test_samples[v3-get_weather_no_history]
tests/test_integration_samples.py::test_samples[v3-several_calls]
tests/test_integration_samples.py::test_samples[v3-no_tools]
tests/test_integration_samples.py::test_samples[v3-get_weather_no_system_prompt]
tests/test_integration_samples.py::test_samples[v3-parallel_calls]
tests/test_mistral_tokenizer.py::TestMistralToknizer::test_from_model
tests/test_mistral_tokenizer.py::TestMistralToknizer::test_decode
tests/test_multimodal.py::test_image_to_num_tokens
tests/test_multimodal.py::test_download_gated_image
tests/test_multimodal.py::test_image_encoder
tests/test_multimodal.py::test_image_processing[size0]
tests/test_multimodal.py::test_image_processing[size1]
tests/test_multimodal.py::test_image_processing[size2]
tests/test_multimodal.py::test_image_processing[size3]
tests/test_multimodal.py::test_image_processing[size4]
tests/test_multimodal.py::test_image_processing[size5]
tests/test_multimodal.py::test_image_encoder_formats
tests/test_normalization.py::TestChatCompletionRequestNormalization::test_user_system_user
tests/test_normalization.py::TestChatCompletionRequestNormalization::test_multiple_system
tests/test_normalization.py::TestChatCompletionRequestNormalization::test_single_system
tests/test_normalization.py::TestChatCompletionRequestNormalization::test_system_assistant_user
tests/test_normalization.py::TestChatCompletionRequestNormalization::test_system_assistant_user_v7
tests/test_normalization.py::TestChatCompletionRequestNormalization::test_assistant_system_user_adds_user
tests/test_normalization.py::TestChatCompletionRequestNormalization::test_assistant_assistant_system_v7
tests/test_normalization.py::TestChatCompletionRequestNormalization::test_message_aggregation
tests/test_normalization.py::TestChatCompletionRequestNormalization::test_normalize_chunks
tests/test_normalization.py::TestChatCompletionRequestNormalization::test_many_chunks_in_user_message
tests/test_normalization.py::TestChatCompletionRequestNormalization::test_safety_prompt_aggregated
tests/test_normalization.py::TestChatCompletionRequestNormalization::test_system_prompt_chunks_aggregated
tests/test_normalization.py::TestChatCompletionRequestNormalization::test_normalize_tools
tests/test_normalization.py::TestChatCompletionRequestNormalization::test_normalize_funcalls
tests/test_normalization.py::TestFineTuningNormalizer::test_normalize_weighted_assistant
tests/test_normalization.py::TestFineTuningNormalizer::test_should_not_aggregate_if_weight_is_different
tests/test_tekken.py::test_roundtrip
tests/test_tekken.py::test_version
tests/test_tekken.py::test_read_from_file
tests/test_tekken.py::test_istekken
tests/test_tekken.py::test_isbyte
tests/test_tokenize_v1.py::test_normal
tests/test_tokenize_v1.py::test_system_singleturn
tests/test_tokenize_v1.py::test_system_multiturn
tests/test_tokenize_v2.py::test_normal
tests/test_tokenize_v2.py::test_tools_singleturn
tests/test_tokenize_v2.py::test_tools_multiturn
tests/test_tokenize_v2.py::test_system_singleturn
tests/test_tokenize_v2.py::test_system_multiturn
tests/test_tokenize_v2.py::test_system_tools_multiturn
tests/test_tokenize_v2.py::test_tool_response
tests/test_tokenize_v2.py::test_tool_message_multiple_shots_without_history
tests/test_tokenize_v3.py::test_is_spm
tests/test_tokenize_v3.py::test_spm_version
tests/test_tokenize_v3.py::test_tools_singleturn[tokenizer0-\u2581-\u2581-6-7-expected_tokens_before_tool0]
tests/test_tokenize_v3.py::test_tools_singleturn[tokenizer1-- -5-6-expected_tokens_before_tool1]
tests/test_tokenize_v3.py::test_tools_multiturn[tokenizer0-\u2581-\u2581-6-7-expected_tokens_before_tool0-expected_tokens_after_tool0]
tests/test_tokenize_v3.py::test_tools_multiturn[tokenizer1-- -5-6-expected_tokens_before_tool1-expected_tokens_after_tool1]
tests/test_tokenize_v3.py::test_system_tools_multiturn[tokenizer0-\u2581-\u2581-6-7-<0x0A><0x0A>-a b-SYSTEM\n\nc d]
tests/test_tokenize_v3.py::test_system_tools_multiturn[tokenizer1-- -5-6-\n\n-ab-SYSTEM\n\ncd]
tests/test_tokenize_v3.py::test_tool_message[tokenizer0-\u2581-\u2581]
tests/test_tokenize_v3.py::test_tool_message[tokenizer1-- ]
tests/test_tokenize_v3.py::test_tool_message_no_id_fine_tuning_ok[tokenizer0-\u2581-\u2581]
tests/test_tokenize_v3.py::test_tool_message_no_id_fine_tuning_ok[tokenizer1-- ]
tests/test_tokenize_v3.py::test_tool_message_multiple_shots_with_history[tokenizer0-\u2581-\u2581]
tests/test_tokenize_v3.py::test_tool_message_multiple_shots_with_history[tokenizer1-- ]
tests/test_tokenize_v3.py::test_tool_message_multiple_calls[tokenizer0-\u2581-\u2581]
tests/test_tokenize_v3.py::test_tool_message_multiple_calls[tokenizer1-- ]
tests/test_tokenizer_v3_mm.py::test_agreement_with_text_only[r0]
tests/test_tokenizer_v3_mm.py::test_agreement_with_text_only[r1]
tests/test_tokenizer_v3_mm.py::test_agreement_with_text_only[r2]
tests/test_tokenizer_v3_mm.py::test_agreement_with_text_only[r3]
tests/test_tokenizer_v3_mm.py::test_swap_text_image_special_case
tests/test_tokenizer_v3_mm.py::test_mm_normalizer[r0]
tests/test_tokenizer_v3_mm.py::test_mm_normalizer[r1]
tests/test_tokenizer_v3_mm.py::test_mm_normalizer[r2]
tests/test_tokenizer_v3_mm.py::test_mm_normalizer[r3]
tests/test_tokenizer_v3_mm.py::test_mm_normalizer[r4]
tests/test_tokenizer_v3_mm.py::test_mm_normalizer[r5]
tests/test_tokenizer_v3_mm.py::test_mm_normalizer[r6]
tests/test_tokenizer_v3_mm.py::test_mm_normalizer[r7]
tests/test_tokenizer_v3_mm.py::test_mm_normalizer[r8]
tests/test_tokenizer_v3_mm.py::test_image_tokenization_integration
tests/test_tokenizer_v7.py::test_tokenize_assistant_message
tests/test_tokenizer_v7.py::test_encode_spm[messages0-<s>[SYSTEM_PROMPT]\u2581a[/SYSTEM_PROMPT][AVAILABLE_TOOLS]\u2581[{"type":\u2581"function",\u2581"function":\u2581{"name":\u2581"t",\u2581"description":\u2581"",\u2581"parameters":\u2581{"type":\u2581"object",\u2581"properties":\u2581{"g":\u2581{"type":\u2581"string"},\u2581"h":\u2581{"type":\u2581"string"}}}}}][/AVAILABLE_TOOLS][INST]\u2581a[/INST]\u2581b[TOOL_CALLS]\u2581[{"name":\u2581"t",\u2581"arguments":\u2581{"g":\u2581"h"}}]</s>]
tests/test_tokenizer_v7.py::test_encode_spm[messages1-<s>[SYSTEM_PROMPT]\u2581a[/SYSTEM_PROMPT][INST]\u2581a[/INST][AVAILABLE_TOOLS]\u2581[{"type":\u2581"function",\u2581"function":\u2581{"name":\u2581"t",\u2581"description":\u2581"",\u2581"parameters":\u2581{"type":\u2581"object",\u2581"properties":\u2581{"g":\u2581{"type":\u2581"string"},\u2581"h":\u2581{"type":\u2581"string"}}}}}][/AVAILABLE_TOOLS][INST]\u2581c[/INST]\u2581b[TOOL_CALLS]\u2581[{"name":\u2581"t",\u2581"arguments":\u2581{"g":\u2581"h"}}]</s>[TOOL_RESULTS]\u25811234[TOOL_CONTENT]\u2581b[/TOOL_RESULTS]]
tests/test_tokenizer_v7.py::test_encode_chat_completion
tests/test_tokenizer_v7.py::test_truncation[keep_sys_and_last_message]
tests/test_tokenizer_v7.py::test_truncation[messages1-<s>[INST]b[/INST][INST]a[/INST][INST]aaaaaaa[/INST]]
tests/test_tokenizer_v7.py::test_truncation[messages2-<s>b</s>[INST]a[/INST][INST]aaaaaaa[/INST]]
tests/test_tokenizer_v7.py::test_truncation[drop_by_chunk_1]
tests/test_tokenizer_v7.py::test_truncation[drop_by_chunk_2]
tests/test_tokenizer_v7.py::test_truncation[full_convo]
tests/test_tokenizer_v7.py::test_truncation_failed[messages0]
tests/test_tokenizer_v7.py::test_truncation_failed[messages1]
tests/test_tokenizer_v7.py::test_from_model
tests/validation/test_chat_validation.py::TestChatValidation::test_multiple_system_messages_OK[validator0]
tests/validation/test_chat_validation.py::TestChatValidation::test_multiple_system_messages_OK[validator1]
tests/validation/test_chat_validation.py::TestChatValidation::test_system_user_messages_OK[validator0]
tests/validation/test_chat_validation.py::TestChatValidation::test_system_user_messages_OK[validator1]
tests/validation/test_chat_validation.py::TestChatValidation::test_user_system_messages_OK[validator0]
tests/validation/test_chat_validation.py::TestChatValidation::test_user_system_messages_OK[validator1]
tests/validation/test_chat_validation.py::TestChatValidation::test_user_user_messages_OK[validator0]
tests/validation/test_chat_validation.py::TestChatValidation::test_user_user_messages_OK[validator1]
tests/validation/test_chat_validation.py::TestChatValidation::test_empty_messages[validator0]
tests/validation/test_chat_validation.py::TestChatValidation::test_empty_messages[validator1]
tests/validation/test_chat_validation.py::TestChatValidation::test_starts_with_system_or_user[validator0]
tests/validation/test_chat_validation.py::TestChatValidation::test_starts_with_system_or_user[validator1]
tests/validation/test_chat_validation.py::TestChatValidation::test_ends_with_assistant[validator0]
tests/validation/test_chat_validation.py::TestChatValidation::test_ends_with_assistant[validator1]
tests/validation/test_chat_validation.py::TestChatValidation::test_assistant_prefix[validator0]
tests/validation/test_chat_validation.py::TestChatValidation::test_assistant_prefix[validator1]
tests/validation/test_chat_validation.py::TestChatValidation::test_user_tool_user[validator0]
tests/validation/test_chat_validation.py::TestChatValidation::test_user_tool_user[validator1]
tests/validation/test_chat_validation.py::TestChatValidation::test_model_none_serving_mode
tests/validation/test_chat_validation.py::TestChatValidation::test_model_none_test_mode
tests/validation/test_chat_validation.py::TestChatValidation::test_tool_calls_OK[validator0]
tests/validation/test_chat_validation.py::TestChatValidation::test_tool_calls_OK[validator1]
tests/validation/test_chat_validation.py::TestChatValidation::test_not_enough_tool_messages[validator0]
tests/validation/test_chat_validation.py::TestChatValidation::test_not_enough_tool_messages[validator1]
tests/validation/test_chat_validation.py::TestChatValidation::test_too_many_tool_messages[validator0]
tests/validation/test_chat_validation.py::TestChatValidation::test_too_many_tool_messages[validator1]
tests/validation/test_finetuning_validation.py::TestFineTuningValidation::test_ends_with_assistant[validator0]
tests/validation/test_finetuning_validation.py::TestFineTuningValidation::test_ends_with_assistant[validator1]
tests/validation/test_finetuning_validation.py::TestFineTuningValidation::test_has_weight_in_message_assistant[validator0]
tests/validation/test_finetuning_validation.py::TestFineTuningValidation::test_has_weight_in_message_assistant[validator1]
tests/validation/test_finetuning_validation.py::TestFineTuningValidation::test_has_invalid_weight_in_message_assistant[validator0]
tests/validation/test_finetuning_validation.py::TestFineTuningValidation::test_has_invalid_weight_in_message_assistant[validator1]
tests/validation/test_finetuning_validation.py::TestFineTuningValidation::test_should_allow_multiple_weights[validator0]
tests/validation/test_finetuning_validation.py::TestFineTuningValidation::test_should_allow_multiple_weights[validator1]
tests/validation/test_finetuning_validation.py::TestFineTuningValidation::test_ends_with_tool_call_null[validator0]
tests/validation/test_finetuning_validation.py::TestFineTuningValidation::test_ends_with_tool_call_null[validator1]
tests/validation/test_finetuning_validation.py::TestFineTuningValidation::test_ends_with_no_tool_call[validator0]
tests/validation/test_finetuning_validation.py::TestFineTuningValidation::test_ends_with_no_tool_call[validator1]
tests/validation/test_finetuning_validation.py::TestFineTuningValidation::test_middle_with_tool_call_null_raises[validator0]
tests/validation/test_finetuning_validation.py::TestFineTuningValidation::test_middle_with_tool_call_null_raises[validator1]
tests/validation/test_finetuning_validation.py::TestFineTuningValidation::test_one_message_with_user_is_not_valid[validator0]
tests/validation/test_finetuning_validation.py::TestFineTuningValidation::test_one_message_with_user_is_not_valid[validator1]
tests/validation/test_request.py::TestValidateRequest::test_request_random_seed_negative
tests/validation/test_serving_validation.py::TestValidateAssistantMessage::test_content_and_tool_calls[validator0]
tests/validation/test_serving_validation.py::TestValidateAssistantMessage::test_content_and_tool_calls[validator1]
tests/validation/test_serving_validation.py::TestValidateAssistantMessage::test_no_content_and_no_tool_calls[validator0--None]
tests/validation/test_serving_validation.py::TestValidateAssistantMessage::test_no_content_and_no_tool_calls[validator0-None-None]
tests/validation/test_serving_validation.py::TestValidateAssistantMessage::test_no_content_and_no_tool_calls[validator0--tool_calls2]
tests/validation/test_serving_validation.py::TestValidateAssistantMessage::test_no_content_and_no_tool_calls[validator0-None-tool_calls3]
tests/validation/test_serving_validation.py::TestValidateAssistantMessage::test_no_content_and_no_tool_calls[validator1--None]
tests/validation/test_serving_validation.py::TestValidateAssistantMessage::test_no_content_and_no_tool_calls[validator1-None-None]
tests/validation/test_serving_validation.py::TestValidateAssistantMessage::test_no_content_and_no_tool_calls[validator1--tool_calls2]
tests/validation/test_serving_validation.py::TestValidateAssistantMessage::test_no_content_and_no_tool_calls[validator1-None-tool_calls3]
tests/validation/test_serving_validation.py::TestValidateAssistantMessage::test_no_content_and_tool_calls[validator0]
tests/validation/test_serving_validation.py::TestValidateAssistantMessage::test_no_content_and_tool_calls[validator1]
tests/validation/test_serving_validation.py::TestValidateAssistantMessage::test_content_and_no_tool_calls[validator0]
tests/validation/test_serving_validation.py::TestValidateAssistantMessage::test_content_and_no_tool_calls[validator1]
tests/validation/test_serving_validation.py::TestValidateAssistantMessage::test_bad_function_name[validator0]
tests/validation/test_serving_validation.py::TestValidateAssistantMessage::test_bad_function_name[validator1]
tests/validation/test_serving_validation.py::TestValidateAssistantMessage::test_invalid_function_json[validator0]
tests/validation/test_serving_validation.py::TestValidateAssistantMessage::test_invalid_function_json[validator1]
tests/validation/test_serving_validation.py::TestValidateAssistantMessage::test_tool_id_defined[validator0]
tests/validation/test_serving_validation.py::TestValidateAssistantMessage::test_tool_id_defined[validator1]
tests/validation/test_serving_validation.py::TestValidateAssistantMessage::test_tool_calls_bad_id[validator0]
tests/validation/test_serving_validation.py::TestValidateAssistantMessage::test_tool_calls_bad_id[validator1]
tests/validation/test_serving_validation.py::TestValidateUserMessage::test_user_message_blank_content_OK[validator0]
tests/validation/test_serving_validation.py::TestValidateUserMessage::test_user_message_blank_content_OK[validator1]
tests/validation/test_serving_validation.py::TestValidateToolMessage::test_tool_message_bad_name[validator0]
tests/validation/test_serving_validation.py::TestValidateToolMessage::test_tool_message_bad_name[validator1]
tests/validation/test_serving_validation.py::TestValidateToolMessage::test_tool_message_invalid_json[validator0]
tests/validation/test_serving_validation.py::TestValidateToolMessage::test_tool_message_invalid_json[validator1]
tests/validation/test_serving_validation.py::TestValidateToolMessage::test_tool_message_bad_id[validator0]
tests/validation/test_serving_validation.py::TestValidateToolMessage::test_tool_message_bad_id[validator1]
tests/validation/test_validation.py::TestValidateTools::test_tool_function_bad_name
tests/validation/test_validation.py::TestValidateTools::test_tool_function_invalid_schema

182 tests collected in 7.93s