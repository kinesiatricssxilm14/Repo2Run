#0 building with "default" instance using docker driver

#1 [internal] load build definition from Dockerfile
#1 transferring dockerfile: 1.19kB done
#1 DONE 0.0s

#2 [internal] load metadata for docker.io/library/python:3.10
#2 DONE 0.0s

#3 [internal] load .dockerignore
#3 transferring context: 2B done
#3 DONE 0.0s

#4 [1/5] FROM docker.io/library/python:3.10
#4 DONE 0.0s

#5 [2/5] RUN mkdir -p ~/.pip && touch ~/.pip/pip.conf &&     echo "[global]" >> ~/.pip/pip.conf && echo "index-url=http://simple/" >> ~/.pip/pip.conf && echo "[install]" >> ~/.pip/pip.conf && echo "trusted-host=pypi..org" >> ~/.pip/pip.conf &&     apt-get update && apt-get install -y curl &&     curl -sSL https://install.python-poetry.org | python -
#5 CACHED

#6 [3/5] RUN pip install pytest pytest-xdist &&     pip install pipdeptree &&     git clone https://github.com/arcee-ai/fastmlx.git &&     mkdir /repo &&     git config --global --add safe.directory /repo &&     cp -r /fastmlx/. /repo && rm -rf /fastmlx/ &&     rm -rf /fastmlx &&     cd /repo && git checkout fd37bc8f8400ce98baf601dcc9b66e14f2618382 &&     pip install mlx==0.18.0 &&     pip install mlx-lm==0.19.2 &&     pip install mlx-vlm==0.0.15 &&     pip install fastapi==0.115.6 &&     pip install jinja2==3.1.4
#6 1.708 Looking in indexes: http://simple/
#6 1.877 Collecting pytest
#6 1.895   Downloading http://packages/pytest/pytest-8.3.4-py3-none-any.whl (343 kB)
#6 1.919      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 343.1/343.1 kB 17.4 MB/s eta 0:00:00
#6 1.991 Collecting pytest-xdist
#6 2.009   Downloading http://packages/pytest-xdist/pytest_xdist-3.6.1-py3-none-any.whl (46 kB)
#6 2.021      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 46.1/46.1 kB 4.6 MB/s eta 0:00:00
#6 2.091 Collecting exceptiongroup>=1.0.0rc8
#6 2.114   Downloading http://packages/exceptiongroup/exceptiongroup-1.2.2-py3-none-any.whl (16 kB)
#6 2.149 Collecting iniconfig
#6 2.188   Downloading http://packages/iniconfig/iniconfig-2.0.0-py3-none-any.whl (5.9 kB)
#6 2.250 Collecting packaging
#6 2.268   Downloading http://packages/packaging/packaging-24.2-py3-none-any.whl (65 kB)
#6 2.281      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 65.5/65.5 kB 7.4 MB/s eta 0:00:00
#6 2.328 Collecting pluggy<2,>=1.5
#6 2.347   Downloading http://packages/pluggy/pluggy-1.5.0-py3-none-any.whl (20 kB)
#6 2.414 Collecting tomli>=1
#6 2.432   Downloading http://packages/tomli/tomli-2.2.1-py3-none-any.whl (14 kB)
#6 2.496 Collecting execnet>=2.1
#6 2.519   Downloading http://packages/execnet/execnet-2.1.1-py3-none-any.whl (40 kB)
#6 2.528      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 40.6/40.6 kB 6.9 MB/s eta 0:00:00
#6 2.681 Installing collected packages: tomli, pluggy, packaging, iniconfig, execnet, exceptiongroup, pytest, pytest-xdist
#6 3.251 Successfully installed exceptiongroup-1.2.2 execnet-2.1.1 iniconfig-2.0.0 packaging-24.2 pluggy-1.5.0 pytest-8.3.4 pytest-xdist-3.6.1 tomli-2.2.1
#6 3.252 WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv
#6 3.375 
#6 3.375 [notice] A new release of pip is available: 23.0.1 -> 24.3.1
#6 3.375 [notice] To update, run: pip install --upgrade pip
#6 4.215 Looking in indexes: http://simple/
#6 4.296 Collecting pipdeptree
#6 4.316   Downloading http://packages/pipdeptree/pipdeptree-2.24.0-py3-none-any.whl (32 kB)
#6 4.341 Requirement already satisfied: packaging>=24.1 in /usr/local/lib/python3.10/site-packages (from pipdeptree) (24.2)
#6 4.495 Collecting pip>=24.2
#6 4.508   Using cached http://packages/pip/pip-24.3.1-py3-none-any.whl (1.8 MB)
#6 4.633 Installing collected packages: pip, pipdeptree
#6 4.633   Attempting uninstall: pip
#6 4.634     Found existing installation: pip 23.0.1
#6 4.792     Uninstalling pip-23.0.1:
#6 4.960       Successfully uninstalled pip-23.0.1
#6 6.219 Successfully installed pip-24.3.1 pipdeptree-2.24.0
#6 6.220 WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv
#6 6.393 Cloning into 'fastmlx'...
#6 13.04 Note: switching to 'fd37bc8f8400ce98baf601dcc9b66e14f2618382'.
#6 13.04 
#6 13.04 You are in 'detached HEAD' state. You can look around, make experimental
#6 13.04 changes and commit them, and you can discard any commits you make in this
#6 13.04 state without impacting any branches by switching back to a branch.
#6 13.04 
#6 13.04 If you want to create a new branch to retain commits you create, you may
#6 13.04 do so (now or later) by using -c with the switch command. Example:
#6 13.04 
#6 13.04   git switch -c <new-branch-name>
#6 13.04 
#6 13.04 Or undo this operation with:
#6 13.04 
#6 13.04   git switch -
#6 13.04 
#6 13.04 Turn off this advice by setting config variable advice.detachedHead to false
#6 13.04 
#6 13.04 HEAD is now at fd37bc8f Fixed default prompt template in config.json (#38)
#6 13.57 Looking in indexes: http://simple/
#6 13.75 Collecting mlx==0.18.0
#6 14.15   Downloading http://packages/mlx/mlx-0.18.0-cp310-cp310-manylinux_2_31_x86_64.whl (12.8 MB)
#6 14.26      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 12.8/12.8 MB 141.0 MB/s eta 0:00:00
#6 14.34 Installing collected packages: mlx
#6 14.76 Successfully installed mlx-0.18.0
#6 14.76 WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable.It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.
#6 15.53 Looking in indexes: http://simple/
#6 15.67 Collecting mlx-lm==0.19.2
#6 15.81   Downloading http://packages/mlx-lm/mlx_lm-0.19.2-py3-none-any.whl (115 kB)
#6 15.83 Requirement already satisfied: mlx>=0.17.0 in /usr/local/lib/python3.10/site-packages (from mlx-lm==0.19.2) (0.18.0)
#6 16.24 Collecting numpy (from mlx-lm==0.19.2)
#6 16.27   Downloading http://packages/numpy/numpy-2.2.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (16.4 MB)
#6 16.39      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 16.4/16.4 MB 168.3 MB/s eta 0:00:00
#6 16.55 Collecting transformers>=4.39.3 (from transformers[sentencepiece]>=4.39.3->mlx-lm==0.19.2)
#6 16.57   Downloading http://packages/transformers/transformers-4.47.1-py3-none-any.whl (10.1 MB)
#6 16.65      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 10.1/10.1 MB 158.6 MB/s eta 0:00:00
#6 17.34 Collecting protobuf (from mlx-lm==0.19.2)
#6 17.35   Downloading http://packages/protobuf/protobuf-5.29.2-cp38-abi3-manylinux2014_x86_64.whl (319 kB)
#6 17.46 Collecting pyyaml (from mlx-lm==0.19.2)
#6 17.48   Downloading http://packages/pyyaml/PyYAML-6.0.2-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (751 kB)
#6 17.51      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 751.2/751.2 kB 39.0 MB/s eta 0:00:00
#6 17.56 Collecting jinja2 (from mlx-lm==0.19.2)
#6 17.58   Downloading http://packages/jinja2/jinja2-3.1.5-py3-none-any.whl (134 kB)
#6 17.65 Collecting filelock (from transformers>=4.39.3->transformers[sentencepiece]>=4.39.3->mlx-lm==0.19.2)
#6 17.65   Using cached http://packages/filelock/filelock-3.16.1-py3-none-any.whl (16 kB)
#6 17.75 Collecting huggingface-hub<1.0,>=0.24.0 (from transformers>=4.39.3->transformers[sentencepiece]>=4.39.3->mlx-lm==0.19.2)
#6 17.77   Downloading http://packages/huggingface-hub/huggingface_hub-0.27.1-py3-none-any.whl (450 kB)
#6 17.85 Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.10/site-packages (from transformers>=4.39.3->transformers[sentencepiece]>=4.39.3->mlx-lm==0.19.2) (24.2)
#6 18.61 Collecting regex!=2019.12.17 (from transformers>=4.39.3->transformers[sentencepiece]>=4.39.3->mlx-lm==0.19.2)
#6 18.63   Downloading http://packages/regex/regex-2024.11.6-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (781 kB)
#6 18.66      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 781.7/781.7 kB 42.8 MB/s eta 0:00:00
#6 18.73 Collecting requests (from transformers>=4.39.3->transformers[sentencepiece]>=4.39.3->mlx-lm==0.19.2)
#6 18.73   Using cached http://packages/requests/requests-2.32.3-py3-none-any.whl (64 kB)
#6 19.08 Collecting tokenizers<0.22,>=0.21 (from transformers>=4.39.3->transformers[sentencepiece]>=4.39.3->mlx-lm==0.19.2)
#6 19.10   Downloading http://packages/tokenizers/tokenizers-0.21.0-cp39-abi3-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (3.0 MB)
#6 19.16      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 3.0/3.0 MB 57.5 MB/s eta 0:00:00
#6 19.44 Collecting safetensors>=0.4.1 (from transformers>=4.39.3->transformers[sentencepiece]>=4.39.3->mlx-lm==0.19.2)
#6 19.47   Downloading http://packages/safetensors/safetensors-0.5.1-cp38-abi3-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (461 kB)
#6 19.62 Collecting tqdm>=4.27 (from transformers>=4.39.3->transformers[sentencepiece]>=4.39.3->mlx-lm==0.19.2)
#6 19.64   Downloading http://packages/tqdm/tqdm-4.67.1-py3-none-any.whl (78 kB)
#6 19.91 Collecting sentencepiece!=0.1.92,>=0.1.91 (from transformers[sentencepiece]>=4.39.3->mlx-lm==0.19.2)
#6 19.93   Downloading http://packages/sentencepiece/sentencepiece-0.2.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (1.3 MB)
#6 19.97      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.3/1.3 MB 57.2 MB/s eta 0:00:00
#6 20.10 Collecting MarkupSafe>=2.0 (from jinja2->mlx-lm==0.19.2)
#6 20.12   Downloading http://packages/markupsafe/MarkupSafe-3.0.2-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (20 kB)
#6 20.19 Collecting fsspec>=2023.5.0 (from huggingface-hub<1.0,>=0.24.0->transformers>=4.39.3->transformers[sentencepiece]>=4.39.3->mlx-lm==0.19.2)
#6 20.21   Downloading http://packages/fsspec/fsspec-2024.12.0-py3-none-any.whl (183 kB)
#6 20.37 Collecting typing-extensions>=3.7.4.3 (from huggingface-hub<1.0,>=0.24.0->transformers>=4.39.3->transformers[sentencepiece]>=4.39.3->mlx-lm==0.19.2)
#6 20.39   Downloading http://packages/typing-extensions/typing_extensions-4.12.2-py3-none-any.whl (37 kB)
#6 20.61 Collecting charset-normalizer<4,>=2 (from requests->transformers>=4.39.3->transformers[sentencepiece]>=4.39.3->mlx-lm==0.19.2)
#6 20.61   Using cached http://packages/charset-normalizer/charset_normalizer-3.4.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (146 kB)
#6 20.64 Collecting idna<4,>=2.5 (from requests->transformers>=4.39.3->transformers[sentencepiece]>=4.39.3->mlx-lm==0.19.2)
#6 20.64   Using cached http://packages/idna/idna-3.10-py3-none-any.whl (70 kB)
#6 20.73 Collecting urllib3<3,>=1.21.1 (from requests->transformers>=4.39.3->transformers[sentencepiece]>=4.39.3->mlx-lm==0.19.2)
#6 20.73   Using cached http://packages/urllib3/urllib3-2.3.0-py3-none-any.whl (128 kB)
#6 20.78 Collecting certifi>=2017.4.17 (from requests->transformers>=4.39.3->transformers[sentencepiece]>=4.39.3->mlx-lm==0.19.2)
#6 20.78   Using cached http://packages/certifi/certifi-2024.12.14-py3-none-any.whl (164 kB)
#6 21.26 Installing collected packages: sentencepiece, urllib3, typing-extensions, tqdm, safetensors, regex, pyyaml, protobuf, numpy, MarkupSafe, idna, fsspec, filelock, charset-normalizer, certifi, requests, jinja2, huggingface-hub, tokenizers, transformers, mlx-lm
#6 34.53 Successfully installed MarkupSafe-3.0.2 certifi-2024.12.14 charset-normalizer-3.4.1 filelock-3.16.1 fsspec-2024.12.0 huggingface-hub-0.27.1 idna-3.10 jinja2-3.1.5 mlx-lm-0.19.2 numpy-2.2.1 protobuf-5.29.2 pyyaml-6.0.2 regex-2024.11.6 requests-2.32.3 safetensors-0.5.1 sentencepiece-0.2.0 tokenizers-0.21.0 tqdm-4.67.1 transformers-4.47.1 typing-extensions-4.12.2 urllib3-2.3.0
#6 34.54 WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable.It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.
#6 36.03 Looking in indexes: http://simple/
#6 36.17 Collecting mlx-vlm==0.0.15
#6 36.24   Downloading http://packages/mlx-vlm/mlx_vlm-0.0.15-py3-none-any.whl (85 kB)
#6 36.27 Requirement already satisfied: mlx>=0.18.0 in /usr/local/lib/python3.10/site-packages (from mlx-vlm==0.0.15) (0.18.0)
#6 36.27 Requirement already satisfied: numpy in /usr/local/lib/python3.10/site-packages (from mlx-vlm==0.0.15) (2.2.1)
#6 36.27 Requirement already satisfied: transformers>=4.45.1 in /usr/local/lib/python3.10/site-packages (from mlx-vlm==0.0.15) (4.47.1)
#6 36.54 Collecting scipy==1.13.1 (from mlx-vlm==0.0.15)
#6 36.57   Downloading http://packages/scipy/scipy-1.13.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (38.6 MB)
#6 36.81      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 38.6/38.6 MB 171.0 MB/s eta 0:00:00
#6 37.22 Collecting gradio>=4.44.0 (from mlx-vlm==0.0.15)
#6 37.24   Downloading http://packages/gradio/gradio-5.10.0-py3-none-any.whl (57.5 MB)
#6 37.65      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 57.5/57.5 MB 145.7 MB/s eta 0:00:00
#6 38.42 Collecting Pillow (from mlx-vlm==0.0.15)
#6 38.45   Downloading http://packages/pillow/pillow-11.1.0-cp310-cp310-manylinux_2_28_x86_64.whl (4.5 MB)
#6 38.52      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 4.5/4.5 MB 73.5 MB/s eta 0:00:00
#6 38.57 Requirement already satisfied: requests in /usr/local/lib/python3.10/site-packages (from mlx-vlm==0.0.15) (2.32.3)
#6 38.62 Collecting aiofiles<24.0,>=22.0 (from gradio>=4.44.0->mlx-vlm==0.0.15)
#6 38.64   Downloading http://packages/aiofiles/aiofiles-23.2.1-py3-none-any.whl (15 kB)
#6 38.72 Collecting anyio<5.0,>=3.0 (from gradio>=4.44.0->mlx-vlm==0.0.15)
#6 38.74   Downloading http://packages/anyio/anyio-4.8.0-py3-none-any.whl (96 kB)
#6 38.91 Collecting fastapi<1.0,>=0.115.2 (from gradio>=4.44.0->mlx-vlm==0.0.15)
#6 38.93   Downloading http://packages/fastapi/fastapi-0.115.6-py3-none-any.whl (94 kB)
#6 38.97 Collecting ffmpy (from gradio>=4.44.0->mlx-vlm==0.0.15)
#6 39.00   Downloading http://packages/ffmpy/ffmpy-0.5.0-py3-none-any.whl (6.0 kB)
#6 39.07 Collecting gradio-client==1.5.3 (from gradio>=4.44.0->mlx-vlm==0.0.15)
#6 39.09   Downloading http://packages/gradio-client/gradio_client-1.5.3-py3-none-any.whl (320 kB)
#6 39.17 Collecting httpx>=0.24.1 (from gradio>=4.44.0->mlx-vlm==0.0.15)
#6 39.19   Downloading http://packages/httpx/httpx-0.28.1-py3-none-any.whl (73 kB)
#6 39.21 Requirement already satisfied: huggingface-hub>=0.25.1 in /usr/local/lib/python3.10/site-packages (from gradio>=4.44.0->mlx-vlm==0.0.15) (0.27.1)
#6 39.21 Requirement already satisfied: jinja2<4.0 in /usr/local/lib/python3.10/site-packages (from gradio>=4.44.0->mlx-vlm==0.0.15) (3.1.5)
#6 39.35 Collecting markupsafe~=2.0 (from gradio>=4.44.0->mlx-vlm==0.0.15)
#6 39.37   Downloading http://packages/markupsafe/MarkupSafe-2.1.5-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (25 kB)
#6 40.03 Collecting orjson~=3.0 (from gradio>=4.44.0->mlx-vlm==0.0.15)
#6 40.06   Downloading http://packages/orjson/orjson-3.10.13-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (131 kB)
#6 40.09 Requirement already satisfied: packaging in /usr/local/lib/python3.10/site-packages (from gradio>=4.44.0->mlx-vlm==0.0.15) (24.2)
#6 40.38 Collecting pandas<3.0,>=1.0 (from gradio>=4.44.0->mlx-vlm==0.0.15)
#6 40.41   Downloading http://packages/pandas/pandas-2.2.3-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (13.1 MB)
#6 40.52      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 13.1/13.1 MB 150.8 MB/s eta 0:00:00
#6 40.92 Collecting pydantic>=2.0 (from gradio>=4.44.0->mlx-vlm==0.0.15)
#6 40.94   Downloading http://packages/pydantic/pydantic-2.10.4-py3-none-any.whl (431 kB)
#6 41.01 Collecting pydub (from gradio>=4.44.0->mlx-vlm==0.0.15)
#6 41.04   Downloading http://packages/pydub/pydub-0.25.1-py2.py3-none-any.whl (32 kB)
#6 41.08 Collecting python-multipart>=0.0.18 (from gradio>=4.44.0->mlx-vlm==0.0.15)
#6 41.09   Downloading http://packages/python-multipart/python_multipart-0.0.20-py3-none-any.whl (24 kB)
#6 41.10 Requirement already satisfied: pyyaml<7.0,>=5.0 in /usr/local/lib/python3.10/site-packages (from gradio>=4.44.0->mlx-vlm==0.0.15) (6.0.2)
#6 42.03 Collecting ruff>=0.2.2 (from gradio>=4.44.0->mlx-vlm==0.0.15)
#6 42.05   Downloading http://packages/ruff/ruff-0.8.6-py3-none-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (11.3 MB)
#6 42.23      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 11.3/11.3 MB 66.0 MB/s eta 0:00:00
#6 42.30 Collecting safehttpx<0.2.0,>=0.1.6 (from gradio>=4.44.0->mlx-vlm==0.0.15)
#6 42.32   Downloading http://packages/safehttpx/safehttpx-0.1.6-py3-none-any.whl (8.7 kB)
#6 42.36 Collecting semantic-version~=2.0 (from gradio>=4.44.0->mlx-vlm==0.0.15)
#6 42.38   Downloading http://packages/semantic-version/semantic_version-2.10.0-py2.py3-none-any.whl (15 kB)
#6 42.50 Collecting starlette<1.0,>=0.40.0 (from gradio>=4.44.0->mlx-vlm==0.0.15)
#6 42.52   Downloading http://packages/starlette/starlette-0.45.2-py3-none-any.whl (71 kB)
#6 42.61 Collecting tomlkit<0.14.0,>=0.12.0 (from gradio>=4.44.0->mlx-vlm==0.0.15)
#6 42.61   Using cached http://packages/tomlkit/tomlkit-0.13.2-py3-none-any.whl (37 kB)
#6 42.66 Collecting typer<1.0,>=0.12 (from gradio>=4.44.0->mlx-vlm==0.0.15)
#6 42.69   Downloading http://packages/typer/typer-0.15.1-py3-none-any.whl (44 kB)
#6 42.70 Requirement already satisfied: typing-extensions~=4.0 in /usr/local/lib/python3.10/site-packages (from gradio>=4.44.0->mlx-vlm==0.0.15) (4.12.2)
#6 42.79 Collecting uvicorn>=0.14.0 (from gradio>=4.44.0->mlx-vlm==0.0.15)
#6 42.81   Downloading http://packages/uvicorn/uvicorn-0.34.0-py3-none-any.whl (62 kB)
#6 42.82 Requirement already satisfied: fsspec in /usr/local/lib/python3.10/site-packages (from gradio-client==1.5.3->gradio>=4.44.0->mlx-vlm==0.0.15) (2024.12.0)
#6 43.02 Collecting websockets<15.0,>=10.0 (from gradio-client==1.5.3->gradio>=4.44.0->mlx-vlm==0.0.15)
#6 43.04   Downloading http://packages/websockets/websockets-14.1-cp310-cp310-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl (168 kB)
#6 43.37 Requirement already satisfied: filelock in /usr/local/lib/python3.10/site-packages (from transformers>=4.45.1->mlx-vlm==0.0.15) (3.16.1)
#6 43.37 Requirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.10/site-packages (from transformers>=4.45.1->mlx-vlm==0.0.15) (2024.11.6)
#6 43.37 Requirement already satisfied: tokenizers<0.22,>=0.21 in /usr/local/lib/python3.10/site-packages (from transformers>=4.45.1->mlx-vlm==0.0.15) (0.21.0)
#6 43.37 Requirement already satisfied: safetensors>=0.4.1 in /usr/local/lib/python3.10/site-packages (from transformers>=4.45.1->mlx-vlm==0.0.15) (0.5.1)
#6 43.37 Requirement already satisfied: tqdm>=4.27 in /usr/local/lib/python3.10/site-packages (from transformers>=4.45.1->mlx-vlm==0.0.15) (4.67.1)
#6 43.38 Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.10/site-packages (from requests->mlx-vlm==0.0.15) (3.4.1)
#6 43.38 Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/site-packages (from requests->mlx-vlm==0.0.15) (3.10)
#6 43.38 Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.10/site-packages (from requests->mlx-vlm==0.0.15) (2.3.0)
#6 43.38 Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/site-packages (from requests->mlx-vlm==0.0.15) (2024.12.14)
#6 43.39 Requirement already satisfied: exceptiongroup>=1.0.2 in /usr/local/lib/python3.10/site-packages (from anyio<5.0,>=3.0->gradio>=4.44.0->mlx-vlm==0.0.15) (1.2.2)
#6 43.40 Collecting sniffio>=1.1 (from anyio<5.0,>=3.0->gradio>=4.44.0->mlx-vlm==0.0.15)
#6 43.42   Downloading http://packages/sniffio/sniffio-1.3.1-py3-none-any.whl (10 kB)
#6 43.45 Collecting starlette<1.0,>=0.40.0 (from gradio>=4.44.0->mlx-vlm==0.0.15)
#6 43.47   Downloading http://packages/starlette/starlette-0.41.3-py3-none-any.whl (73 kB)
#6 43.60 Collecting httpcore==1.* (from httpx>=0.24.1->gradio>=4.44.0->mlx-vlm==0.0.15)
#6 43.62   Downloading http://packages/httpcore/httpcore-1.0.7-py3-none-any.whl (78 kB)
#6 43.66 Collecting h11<0.15,>=0.13 (from httpcore==1.*->httpx>=0.24.1->gradio>=4.44.0->mlx-vlm==0.0.15)
#6 43.68   Downloading http://packages/h11/h11-0.14.0-py3-none-any.whl (58 kB)
#6 43.79 Collecting python-dateutil>=2.8.2 (from pandas<3.0,>=1.0->gradio>=4.44.0->mlx-vlm==0.0.15)
#6 43.82   Downloading http://packages/python-dateutil/python_dateutil-2.9.0.post0-py2.py3-none-any.whl (229 kB)
#6 43.96 Collecting pytz>=2020.1 (from pandas<3.0,>=1.0->gradio>=4.44.0->mlx-vlm==0.0.15)
#6 43.98   Downloading http://packages/pytz/pytz-2024.2-py2.py3-none-any.whl (508 kB)
#6 44.05 Collecting tzdata>=2022.7 (from pandas<3.0,>=1.0->gradio>=4.44.0->mlx-vlm==0.0.15)
#6 44.07   Downloading http://packages/tzdata/tzdata-2024.2-py2.py3-none-any.whl (346 kB)
#6 44.13 Collecting annotated-types>=0.6.0 (from pydantic>=2.0->gradio>=4.44.0->mlx-vlm==0.0.15)
#6 44.15   Downloading http://packages/annotated-types/annotated_types-0.7.0-py3-none-any.whl (13 kB)
#6 45.65 Collecting pydantic-core==2.27.2 (from pydantic>=2.0->gradio>=4.44.0->mlx-vlm==0.0.15)
#6 45.67   Downloading http://packages/pydantic-core/pydantic_core-2.27.2-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (2.0 MB)
#6 45.72      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 2.0/2.0 MB 68.1 MB/s eta 0:00:00
#6 45.84 Collecting click>=8.0.0 (from typer<1.0,>=0.12->gradio>=4.44.0->mlx-vlm==0.0.15)
#6 45.86   Downloading http://packages/click/click-8.1.8-py3-none-any.whl (98 kB)
#6 45.92 Collecting shellingham>=1.3.0 (from typer<1.0,>=0.12->gradio>=4.44.0->mlx-vlm==0.0.15)
#6 45.92   Using cached http://packages/shellingham/shellingham-1.5.4-py2.py3-none-any.whl (9.8 kB)
#6 46.05 Collecting rich>=10.11.0 (from typer<1.0,>=0.12->gradio>=4.44.0->mlx-vlm==0.0.15)
#6 46.35   Downloading http://packages/rich/rich-13.9.4-py3-none-any.whl (242 kB)
#6 46.51 Collecting six>=1.5 (from python-dateutil>=2.8.2->pandas<3.0,>=1.0->gradio>=4.44.0->mlx-vlm==0.0.15)
#6 46.53   Downloading http://packages/six/six-1.17.0-py2.py3-none-any.whl (11 kB)
#6 46.59 Collecting markdown-it-py>=2.2.0 (from rich>=10.11.0->typer<1.0,>=0.12->gradio>=4.44.0->mlx-vlm==0.0.15)
#6 46.61   Downloading http://packages/markdown-it-py/markdown_it_py-3.0.0-py3-none-any.whl (87 kB)
#6 46.70 Collecting pygments<3.0.0,>=2.13.0 (from rich>=10.11.0->typer<1.0,>=0.12->gradio>=4.44.0->mlx-vlm==0.0.15)
#6 46.72   Downloading http://packages/pygments/pygments-2.19.1-py3-none-any.whl (1.2 MB)
#6 46.76      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.2/1.2 MB 43.3 MB/s eta 0:00:00
#6 46.81 Collecting mdurl~=0.1 (from markdown-it-py>=2.2.0->rich>=10.11.0->typer<1.0,>=0.12->gradio>=4.44.0->mlx-vlm==0.0.15)
#6 46.82   Downloading http://packages/mdurl/mdurl-0.1.2-py3-none-any.whl (10.0 kB)
#6 47.32 Installing collected packages: pytz, pydub, websockets, tzdata, tomlkit, sniffio, six, shellingham, semantic-version, scipy, ruff, python-multipart, pygments, pydantic-core, Pillow, orjson, mdurl, markupsafe, h11, ffmpy, click, annotated-types, aiofiles, uvicorn, python-dateutil, pydantic, markdown-it-py, httpcore, anyio, starlette, rich, pandas, httpx, typer, safehttpx, gradio-client, fastapi, gradio, mlx-vlm
#6 55.27   Attempting uninstall: markupsafe
#6 55.27     Found existing installation: MarkupSafe 3.0.2
#6 55.27     Uninstalling MarkupSafe-3.0.2:
#6 55.28       Successfully uninstalled MarkupSafe-3.0.2
#6 65.73 Successfully installed Pillow-11.1.0 aiofiles-23.2.1 annotated-types-0.7.0 anyio-4.8.0 click-8.1.8 fastapi-0.115.6 ffmpy-0.5.0 gradio-5.10.0 gradio-client-1.5.3 h11-0.14.0 httpcore-1.0.7 httpx-0.28.1 markdown-it-py-3.0.0 markupsafe-2.1.5 mdurl-0.1.2 mlx-vlm-0.0.15 orjson-3.10.13 pandas-2.2.3 pydantic-2.10.4 pydantic-core-2.27.2 pydub-0.25.1 pygments-2.19.1 python-dateutil-2.9.0.post0 python-multipart-0.0.20 pytz-2024.2 rich-13.9.4 ruff-0.8.6 safehttpx-0.1.6 scipy-1.13.1 semantic-version-2.10.0 shellingham-1.5.4 six-1.17.0 sniffio-1.3.1 starlette-0.41.3 tomlkit-0.13.2 typer-0.15.1 tzdata-2024.2 uvicorn-0.34.0 websockets-14.1
#6 65.73 WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable.It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.
#6 67.60 Looking in indexes: http://simple/
#6 67.60 Requirement already satisfied: fastapi==0.115.6 in /usr/local/lib/python3.10/site-packages (0.115.6)
#6 67.61 Requirement already satisfied: starlette<0.42.0,>=0.40.0 in /usr/local/lib/python3.10/site-packages (from fastapi==0.115.6) (0.41.3)
#6 67.61 Requirement already satisfied: pydantic!=1.8,!=1.8.1,!=2.0.0,!=2.0.1,!=2.1.0,<3.0.0,>=1.7.4 in /usr/local/lib/python3.10/site-packages (from fastapi==0.115.6) (2.10.4)
#6 67.61 Requirement already satisfied: typing-extensions>=4.8.0 in /usr/local/lib/python3.10/site-packages (from fastapi==0.115.6) (4.12.2)
#6 67.61 Requirement already satisfied: annotated-types>=0.6.0 in /usr/local/lib/python3.10/site-packages (from pydantic!=1.8,!=1.8.1,!=2.0.0,!=2.0.1,!=2.1.0,<3.0.0,>=1.7.4->fastapi==0.115.6) (0.7.0)
#6 67.62 Requirement already satisfied: pydantic-core==2.27.2 in /usr/local/lib/python3.10/site-packages (from pydantic!=1.8,!=1.8.1,!=2.0.0,!=2.0.1,!=2.1.0,<3.0.0,>=1.7.4->fastapi==0.115.6) (2.27.2)
#6 67.62 Requirement already satisfied: anyio<5,>=3.4.0 in /usr/local/lib/python3.10/site-packages (from starlette<0.42.0,>=0.40.0->fastapi==0.115.6) (4.8.0)
#6 67.63 Requirement already satisfied: exceptiongroup>=1.0.2 in /usr/local/lib/python3.10/site-packages (from anyio<5,>=3.4.0->starlette<0.42.0,>=0.40.0->fastapi==0.115.6) (1.2.2)
#6 67.63 Requirement already satisfied: idna>=2.8 in /usr/local/lib/python3.10/site-packages (from anyio<5,>=3.4.0->starlette<0.42.0,>=0.40.0->fastapi==0.115.6) (3.10)
#6 67.63 Requirement already satisfied: sniffio>=1.1 in /usr/local/lib/python3.10/site-packages (from anyio<5,>=3.4.0->starlette<0.42.0,>=0.40.0->fastapi==0.115.6) (1.3.1)
#6 68.22 WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable.It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.
#6 68.96 Looking in indexes: http://simple/
#6 69.01 Collecting jinja2==3.1.4
#6 69.03   Downloading http://packages/jinja2/jinja2-3.1.4-py3-none-any.whl (133 kB)
#6 69.05 Requirement already satisfied: MarkupSafe>=2.0 in /usr/local/lib/python3.10/site-packages (from jinja2==3.1.4) (2.1.5)
#6 69.63 Installing collected packages: jinja2
#6 69.63   Attempting uninstall: jinja2
#6 69.63     Found existing installation: Jinja2 3.1.5
#6 69.64     Uninstalling Jinja2-3.1.5:
#6 69.64       Successfully uninstalled Jinja2-3.1.5
#6 69.77 Successfully installed jinja2-3.1.4
#6 69.77 WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable.It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.
#6 DONE 71.9s

#7 [4/5] RUN cd /repo && pytest --collect-only -q
#7 2.593 tests/test_fastmlx.py::test_chat_completion_vlm
#7 2.593 tests/test_fastmlx.py::test_chat_completion_lm
#7 2.593 tests/test_fastmlx.py::test_vlm_streaming
#7 2.593 tests/test_fastmlx.py::test_lm_streaming
#7 2.593 tests/test_fastmlx.py::test_get_supported_models
#7 2.593 tests/test_fastmlx.py::test_list_models
#7 2.593 tests/test_fastmlx.py::test_add_model
#7 2.593 tests/test_fastmlx.py::test_remove_model
#7 2.593 tests/test_fastmlx.py::test_handle_function_calls_json_format
#7 2.593 tests/test_fastmlx.py::test_handle_function_calls_xml_format_old
#7 2.593 tests/test_fastmlx.py::test_handle_function_calls_xml_format_new
#7 2.593 tests/test_fastmlx.py::test_handle_function_calls_functools_format
#7 2.593 tests/test_fastmlx.py::test_handle_function_calls_multiple_functools
#7 2.593 
#7 2.593 =============================== warnings summary ===============================
#7 2.593 tests/test_fastmlx.py:127
#7 2.593   /repo/tests/test_fastmlx.py:127: PytestUnknownMarkWarning: Unknown pytest.mark.asyncio - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
#7 2.593     @pytest.mark.asyncio
#7 2.593 
#7 2.593 tests/test_fastmlx.py:168
#7 2.593   /repo/tests/test_fastmlx.py:168: PytestUnknownMarkWarning: Unknown pytest.mark.asyncio - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
#7 2.593     @pytest.mark.asyncio
#7 2.593 
#7 2.593 -- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
#7 2.593 13 tests collected in 1.68s
#7 DONE 3.0s

#8 exporting to image
#8 exporting layers
#8 exporting layers 7.1s done
#8 writing image sha256:3f7a22901b9871dc39ad9e54686bdbd4b448bc6a45945ba78ab255de53644d42 done
#8 naming to docker.io/library/tmp:tmp done
#8 DONE 7.1s
